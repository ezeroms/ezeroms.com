<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8">
    <title>Hugo &#43; Netlify &#43; DecapCMS を使ったサイト構築</title>

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/atom-one-dark-min.css">

    <link rel="stylesheet" href="/css/main.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" type="image/x-icon" href="/images/common/favicon/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/common/favicon/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/common/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/images/common/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/images/common/favicon/favicon-192x192.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/common/favicon/apple-touch-icon.png">

    
    <meta property="og:title" content="Hugo &#43; Netlify &#43; DecapCMS を使ったサイト構築">
    <meta property="og:description" content="One thing I can tell you is you got to be free!">
    <meta property="og:type" content="website">
    <meta property="og:url" content="http://localhost:1313/diary/building-a-website-with-hugo-netlify-decap-cms/">
    <meta property="og:image" content="/images/common/og-image.png">
    <meta property="og:site_name" content="ezeroms.com">
    <meta property="og:locale" content="ja_JP">
</head>
<body>
    
<header class="header">
  <nav class="header__nav">
      <a href="/about">About</a>
      <a href="/work">Work</a>
      <a href="/diary">Diary</a>
      </ul>
  </nav>

  <a href="/" class="header__logo">
      <img src="/images/common/logo.svg" alt="ezeroms.com">
  </a>

  <div class="header__button">
    <a href="/shoulders-of-giants">
      The shoulders of Giants
    </a>
  </div>
</header>
<header class="sp-header">
  <img src="/images/common/diary.svg" alt="" class="logo_diary" onclick="topFunction()" id="scrollTopButton" title="Go to top">
  <button id="openModal">
    <img src="/images/common/icon_list.svg">
  </button>
</header>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<script>
  $(document).ready(function(){
      
      $('#scrollTopButton').click(function(){
          
          $('html, body').animate({scrollTop : 0},800);
          return false;
      });
  });
  </script>

<div id="overlay"></div>
<div id="modal">
  <div class="modal_close-list">
    
    <button class="shuffle" id="reloadPage">
      <img src="/images/common/icon_latest.svg" alt="">
      Latest
    </button>
    
    <button id="closeModal">
      <img src="/images/common/icon_close.svg" alt="">
      Close
    </button>
  </div>

    <div id="modalContent">
        
      <ul>
        <li><a href="/subject/news/" class="a-link">ニュース</a></li>
        <li><a href="/subject/music/" class="a-link">音楽</a></li>
        <li><a href="/subject/manga-and-anime/" class="a-link">漫画・アニメ</a></li>
        <li><a href="/subject/movies-and-dramas/" class="a-link">映画・ドラマ</a></li>
        <li><a href="/subject/comedy/" class="a-link">お笑い</a></li>
        <li><a href="/subject/gaming/" class="a-link">ゲーム</a></li>
        <li><a href="/subject/sports/" class="a-link">スポーツ</a></li>
        <li><a href="/subject/books-and-magazines/" class="a-link">本・雑誌</a></li>
        <li><a href="/subject/languages-and-foreign-cultures/" class="a-link">言語・海外文化</a></li>
        <li><a href="/subject/design/" class="a-link">デザイン</a></li>
        <li><a href="/subject/internet-and-technology/" class="a-link">インターネット・技術</a></li>
        <li><a href="/subject/natural-science/" class="a-link">自然科学</a></li>
        <li><a href="/subject/humanities-and-social-sciences/" class="a-link">人文・社会科学</a></li>
    </ul>

    <ul>
        
        
            
            
                
            
        
            
            
                
            
        
            
            
        
            
            
                
            
        
            
            
        
            
            
                
            
        
            
            
                
            
        
        
        
        
            
            
            <li><a href="/month/2024-06" class="a-link">2024-06</a></li>
        
            
            
            <li><a href="/month/2024-05" class="a-link">2024-05</a></li>
        
            
            
            <li><a href="/month/2024-03" class="a-link">2024-03</a></li>
        
            
            
            <li><a href="/month/2024-02" class="a-link">2024-02</a></li>
        
            
            
            <li><a href="/month/2023-08" class="a-link">2023-08</a></li>
        
    </ul>
    </div>
</div>

<script>
$(document).ready(function(){
    
    $('#openModal').click(function(){
        $('#overlay').fadeIn();
        $('#modal').slideDown();
        
        $('body').addClass('modal-open');
    });

    
    $('#closeModal, #overlay').click(function(){
        $('#overlay').fadeOut();
        $('#modal').slideUp();
        
        $('body').removeClass('modal-open');
    });

    
    $('#reloadPage').click(function() {
        
        $('#overlay').fadeOut();
        $('#modal').slideUp(function() {
            
            window.location.href = "/diary/";
        });
    });

});
  </script>
  
<div id="notification" class="notification">
    Link copied to clipboard!
</div>

<main class="main-section">
    <aside class="main-section-2column__left">
    <ul>
        <li><a href="/subject/news/">ニュース</a></li>
        <li><a href="/subject/music/">音楽</a></li>
        <li><a href="/subject/manga-and-anime/">漫画・アニメ</a></li>
        <li><a href="/subject/movies-and-dramas/">映画・ドラマ</a></li>
        <li><a href="/subject/comedy/">お笑い</a></li>
        <li><a href="/subject/gaming/">ゲーム</a></li>
        <li><a href="/subject/sports/">スポーツ</a></li>
        <li><a href="/subject/books-and-magazines/">本・雑誌</a></li>
        <li><a href="/subject/languages-and-foreign-cultures/">言語・海外文化</a></li>
        <li><a href="/subject/design-and-creative/">デザイン・クリエイティブ</a></li>
        <li><a href="/subject/internet-and-technology/">インターネット・技術</a></li>
        <li><a href="/subject/natural-science/">自然科学</a></li>
        <li><a href="/subject/humanities-and-social-sciences/">人文・社会科学</a></li>
    </ul>

    <ul>
        
        
            
            
                
            
        
            
            
                
            
        
            
            
        
            
            
                
            
        
            
            
        
            
            
                
            
        
            
            
                
            
        
        
        
        
            
            
            <li><a href="/month/2024-06">2024-06</a></li>
        
            
            
            <li><a href="/month/2024-05">2024-05</a></li>
        
            
            
            <li><a href="/month/2024-03">2024-03</a></li>
        
            
            
            <li><a href="/month/2024-02">2024-02</a></li>
        
            
            
            <li><a href="/month/2023-08">2023-08</a></li>
        

    </ul>
</aside>

    <section class="main-section-2column__right">
        <ul class="article-container" id="articles-list">

            <div class="article-item-heading">
                <div class="article-item-heading__label">
                    <p class="article-item-heading__label__p">
                        2024-06-09
                    </p>
                    <h2 class="article-item-heading__label__h2">
                        Hugo &#43; Netlify &#43; DecapCMS を使ったサイト構築
                    </h2>
                </div>

                
                <button class="article-item-heading__button" onclick="copyToClipboard()">
                    <img src="/images/common/icon_link.svg" alt="Get article url">
                </button>
                <script>
                    function copyToClipboard() {
                        const url = window.location.href;
                        navigator.clipboard.writeText(url).then(function() {
                            showNotification();
                        }, function(err) {
                            console.error('リンクの保存に失敗しました: ', err);
                        });
                    }
                    function showNotification() {
                        var notification = document.getElementById("notification");
                        notification.className = "notification show";
                        setTimeout(function() {
                            notification.className = notification.className.replace(" show", "");
                        }, 3000);
                    }
                </script>
                        
            </div>


            <article class="article-item">
                <p>35歳の誕生日を機に、個人サイト（ブログ）をリニューアルすることにした。</p>
<p>以前より、Hugo + Netlify を使って個人サイトを配信していたのだが、この仕組みには「記事の更新作業に手間がかかる」という問題があった。つまり、静的サイトジェネレーター兼コンテンツ管理として Hugo があり、Netlify がホスティングを担っているのだが、実際に記事を更新する際は、次のような手順となる。</p>
<ul>
<li>Github リポジトリを pull する（僕は複数台のマシンを使っているので、ローカルを最新状態に同期する必要がある。）</li>
<li>mdファイルを追加し、そこにブログ記事を書く</li>
<li>Github に push する</li>
<li>Netlify が更新を検知し、build → deploy を実行する（＝サイトが更新される）</li>
</ul>
<p>この手順から、Github に対する操作を省きたい。つまり、一般的なブログサービスのように（あるいは Wordpress サイトのように）「ブラウザで管理画面を開き、記事を更新する」という手続きにしたい。</p>
<p>そこで Decap CMS（旧・Netlify CMS）を使ってみることにした。ヘッドレスCMSの代表格で、特に　という点が大きい。</p>
<p>また、併せてサイトのデザインも一新することにした。以前は Hugo に不慣れなこともあり、無料配布されていた Hugo テーマを流用して改造しながら使っていたのだが、その運用を4〜5年ほどしたことで、Hugo の仕組みにもだいぶ詳しくなった。そこで、フルスクラッチで Hugo テーマを作ることにした。</p>
<h2 id="各ツールの役割の確認">各ツールの役割の確認</h2>
<ul>
<li>Hugo : 静的サイトジェネレーター。Markdown ファイルを HTML に変換して静的なウェブサイトを生成してくれる。平成元年生まれのインターネット小僧として、静的サイトへのロマンは捨てがたい。Golangで書かれているため動作が高速で、Goテンプレートエンジンによる柔軟なテンプレートシステムが魅力的。</li>
<li>Netlify : 静的サイトのホスティングサービス。Git リポジトリと連携して自動デプロイを行う。</li>
<li>Decap CMS : オープンソースのヘッドレスCMS。GUIベースの管理画面を提供し、静的サイトジェネレーターと連携してコンテンツを管理する。実装後に重要な落とし穴が発覚する。</li>
</ul>
<h2 id="1-サイトの基本形を作成">1. サイトの基本形を作成</h2>
<p>まずはまっさらな状態から Hugo プロジェクトを作っていく。</p>
<h3 id="1-hugo-プロジェクトを作成">1. Hugo プロジェクトを作成</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>hugo new site ezeroms.com
</span></span><span style="display:flex;"><span>cd ezeroms.com
</span></span></code></pre></div><h3 id="2-カスタムテーマの準備">2. カスタムテーマの準備</h3>
<p>Hugo プロジェクトで推奨されている形は、root ディレクトリの下に `/site` とかで区切って、テーマ等を置くディレクトリを一段下で管理する方法だ。これは、root ディレクトリでサイト設計やデプロイに関するメタ情報を管理し、具体的なサイト自身の設定や見た目と分離することで、複数テーマも管理やスケーラビリティを確保しようとするものだ。</p>
<p>しかし、今回のサイトの場合はテーマを切り替えることはない（自分でアップデートし続ける）し、プロジェクトの規模も小さいので、構造のシンプルさを優先して全て root ディレクトリ直下で管理する方法にした。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ezeroms.com
</span></span><span style="display:flex;"><span>├── archetypes
</span></span><span style="display:flex;"><span>│   └── index.html
</span></span><span style="display:flex;"><span>├── content
</span></span><span style="display:flex;"><span>│   ├── about
</span></span><span style="display:flex;"><span>│   │   └── _index.md
</span></span><span style="display:flex;"><span>│   ├── diary
</span></span><span style="display:flex;"><span>│   │   └── _index.md
</span></span><span style="display:flex;"><span>│   ├── shoulders-of-giants
</span></span><span style="display:flex;"><span>│   │   └── _index.md
</span></span><span style="display:flex;"><span>│   └── work
</span></span><span style="display:flex;"><span>│       └── _index.md
</span></span><span style="display:flex;"><span>├── layouts
</span></span><span style="display:flex;"><span>│   ├── _default
</span></span><span style="display:flex;"><span>│   │   ├── baseof.html
</span></span><span style="display:flex;"><span>│   │   └── rss.xml
</span></span><span style="display:flex;"><span>│   ├── about
</span></span><span style="display:flex;"><span>│   │   └── index.html
</span></span><span style="display:flex;"><span>│   ├── diary
</span></span><span style="display:flex;"><span>│   │   ├── index.html
</span></span><span style="display:flex;"><span>│   │   └── single.html
</span></span><span style="display:flex;"><span>│   ├── month
</span></span><span style="display:flex;"><span>│   │   └── list.html
</span></span><span style="display:flex;"><span>│   ├── partials
</span></span><span style="display:flex;"><span>│   │   ├── header.html
</span></span><span style="display:flex;"><span>│   │   ├── footer.html
</span></span><span style="display:flex;"><span>│   │   ├── global-nav.html
</span></span><span style="display:flex;"><span>│   │   └── ...
</span></span><span style="display:flex;"><span>│   ├── shoulders-of-giants
</span></span><span style="display:flex;"><span>│   │   └── index.html
</span></span><span style="display:flex;"><span>│   ├── subject
</span></span><span style="display:flex;"><span>│   │   └── list.html
</span></span><span style="display:flex;"><span>│   ├── topic
</span></span><span style="display:flex;"><span>│   │   └── list.html
</span></span><span style="display:flex;"><span>│   │── work
</span></span><span style="display:flex;"><span>│   │   ├── index.html
</span></span><span style="display:flex;"><span>│   │   └── single.html
</span></span><span style="display:flex;"><span>│   └── index.html
</span></span><span style="display:flex;"><span>├── public
</span></span><span style="display:flex;"><span>├── static
</span></span><span style="display:flex;"><span>│   ├── admin
</span></span><span style="display:flex;"><span>│   │   ├── config.yml
</span></span><span style="display:flex;"><span>│   │   └── index.html
</span></span><span style="display:flex;"><span>│   ├── css
</span></span><span style="display:flex;"><span>│   └── images
</span></span><span style="display:flex;"><span>├── config.toml
</span></span><span style="display:flex;"><span>└── netlify.toml
</span></span></code></pre></div><ul>
<li>public : hugo server  で build されたファイルが格納される場所。キャッシュが邪魔しているのか？と思ったときは全削除したりする。</li>
<li>content/*/_index.md : 一見不要そうだが、ここに index の md ファイルがないとディレクトリを正しく認識してくれない。</li>
<li>static/admin : Decap CMS の管理画面用のファイル群。</li>
</ul>
<h2 id="2-本番環境と自動デプロイの設定">2. 本番環境と自動デプロイの設定</h2>
<h3 id="1-github-リポジトリの作成">1. GitHub リポジトリの作成</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>git init
</span></span><span style="display:flex;"><span>git add .
</span></span><span style="display:flex;"><span>git commit -m <span style="color:#e6db74">&#34;Initial commit&#34;</span>
</span></span><span style="display:flex;"><span>git remote add origin &lt;GITHUB_REPO_URL&gt;
</span></span><span style="display:flex;"><span>git push -u origin main
</span></span></code></pre></div><h3 id="2-netlify-アカウントの作成">2. Netlify アカウントの作成</h3>
<h3 id="3-githubリポジトリの連携">3. Githubリポジトリの連携</h3>
<p>Netlify の管理画面で「New site from Git」を選択し、GitHubリポジトリを連携。</p>
<h3 id="4-ビルド設定">4. ビルド設定</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>Build Command: hugo
</span></span><span style="display:flex;"><span>Publish Directory: public
</span></span></code></pre></div><p>これで、Github の main ブランチが更新されると、Netlify側で自動デプロイが走るようになる。</p>
<h3 id="5-ドメイン設定">5. ドメイン設定</h3>
<p>Netlify の管理画面で <code>ezeroms.com</code> を割り当てる。</p>
<h2 id="3-詳細なサイト構築テーマファイルの編集">3. 詳細なサイト構築（テーマファイルの編集）</h2>
<p>layouts 以下のテーマファイルと static/css をひらすら編集し、理想的なデザインを作り上げていく。自分一人のプロジェクトということもあり、あらかじめ全てのページを Figma で作ることはせず、主だったページのレイアウト構成だけ Figma 上で検証して、スタイリングについては実装しながら検討していった。褒められた方法ではないが、こういうところがソロ・プロジェクトの爽快なところだ。</p>
<h3 id="コツ--テーマファイルへのマーキング">コツ : テーマファイルへのマーキング</h3>
<p>hugo server  で localhost を確認しながら作っていくのだが、描画されているページに適切なテーマファイルが当たっているのかどうか分からなくなる。（「このページにこのテーマファイルが当たってほしいのに当たらん〜〜〜〜」的なことが続く） 途中で全部のテーマファイルにマーキングして、config.toml とファイル名やディレクトリを弄りながら検証していった。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!-- debug-info --&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">p</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;debug-info&#34;</span>&gt;File : /layouts/subject/list.html&lt;/<span style="color:#f92672">p</span>&gt;
</span></span></code></pre></div><p>最終的にこんなかんじで出来上がる。</p>
<p>写真</p>
<p>本当はもっとURLスキームに拘りたかったのだが、どうやってもできず（Decap CMS管理の範囲外を作ることになり）断念した。いい方法を知っている人がいたら教えてほしい。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># 理想的なURLスキーム</span>
</span></span><span style="display:flex;"><span>ezeroms.com/diary/
</span></span><span style="display:flex;"><span>ezeroms.com/diary/subject/news/
</span></span><span style="display:flex;"><span>ezeroms.com/diary/month/2024-06/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 実際のURLスキーム</span>
</span></span><span style="display:flex;"><span>ezeroms.com/diary/
</span></span><span style="display:flex;"><span>ezeroms.com/subject/news/
</span></span><span style="display:flex;"><span>ezeroms.com/month/2024-06/
</span></span></code></pre></div><h2 id="4-cmsを導入してブラウザから更新できるようにする">4. CMSを導入してブラウザから更新できるようにする</h2>
<p>package.json を作成し、Decap CMSをインストール。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>npm init -y
</span></span><span style="display:flex;"><span>npm install netlify-cms-app
</span></span></code></pre></div><p>static/admin ディレクトリの config.yml 、index.html を編集してセットアップし、ezeroms.com/admin にアクセスすれば管理画面が使えるようになる。めっちゃ簡単だ。</p>
<p>管理画面の自由度がとても高く config.yml で設定すると一覧の表示項目も柔軟に変更することができる。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">backend</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">git-gateway</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">branch</span>: <span style="color:#ae81ff">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">media_folder</span>: <span style="color:#e6db74">&#34;/static/images/uploads&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">public_folder</span>: <span style="color:#e6db74">&#34;/images/uploads&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">collections</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#34;about&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">label</span>: <span style="color:#e6db74">&#34;About&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">folder</span>: <span style="color:#e6db74">&#34;content/about&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">create</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">slug</span>: <span style="color:#e6db74">&#34;{{fields.slug}}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">fields</span>:
</span></span><span style="display:flex;"><span>      - { <span style="color:#f92672">label</span>: <span style="color:#e6db74">&#34;Body&#34;</span><span style="color:#f92672">, name</span>: <span style="color:#e6db74">&#34;body&#34;</span><span style="color:#f92672">, widget</span>: <span style="color:#e6db74">&#34;markdown&#34;</span> }
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">summary</span>: <span style="color:#e6db74">&#34;{{body}}&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#34;diary&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">label</span>: <span style="color:#e6db74">&#34;Diary&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">folder</span>: <span style="color:#e6db74">&#34;content/diary&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">create</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">slug</span>: <span style="color:#e6db74">&#34;{{fields.slug}}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">media_folder</span>: <span style="color:#e6db74">&#34;/static/images/diary/{{fields.slug}}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">public_folder</span>: <span style="color:#e6db74">&#34;/images/diary/{{fields.slug}}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">fields</span>:
</span></span><span style="display:flex;"><span>      - { <span style="color:#f92672">label</span>: <span style="color:#e6db74">&#34;Title&#34;</span><span style="color:#f92672">, name</span>: <span style="color:#e6db74">&#34;title&#34;</span><span style="color:#f92672">, widget</span>: <span style="color:#e6db74">&#34;string&#34;</span> }
</span></span><span style="display:flex;"><span>      - { <span style="color:#f92672">label</span>: <span style="color:#e6db74">&#34;Date&#34;</span><span style="color:#f92672">, name</span>: <span style="color:#e6db74">&#34;date&#34;</span><span style="color:#f92672">, widget</span>: <span style="color:#e6db74">&#34;datetime&#34;</span><span style="color:#f92672">, date_format</span>: <span style="color:#e6db74">&#34;YYYY-MM-DD&#34;</span><span style="color:#f92672">, time_format</span>: <span style="color:#66d9ef">false</span> }
</span></span><span style="display:flex;"><span>      - { <span style="color:#f92672">label</span>: <span style="color:#e6db74">&#34;Slug&#34;</span><span style="color:#f92672">, name</span>: <span style="color:#e6db74">&#34;slug&#34;</span><span style="color:#f92672">, widget</span>: <span style="color:#e6db74">&#34;string&#34;</span> }
</span></span><span style="display:flex;"><span>      - { <span style="color:#f92672">label</span>: <span style="color:#e6db74">&#34;Month&#34;</span><span style="color:#f92672">, name</span>: <span style="color:#e6db74">&#34;month&#34;</span><span style="color:#f92672">, widget</span>: <span style="color:#e6db74">&#34;list&#34;</span> }
</span></span><span style="display:flex;"><span>      - { <span style="color:#f92672">label</span>: <span style="color:#e6db74">&#34;Subject&#34;</span><span style="color:#f92672">, name</span>: <span style="color:#e6db74">&#34;subject&#34;</span><span style="color:#f92672">, widget</span>: <span style="color:#e6db74">&#34;select&#34;</span><span style="color:#f92672">, multiple: true, options</span>: [<span style="color:#e6db74">&#34;news&#34;</span>, <span style="color:#e6db74">&#34;music&#34;</span>, <span style="color:#e6db74">&#34;manga-and-anime&#34;</span>, <span style="color:#e6db74">&#34;movies-and-dramas&#34;</span>, <span style="color:#e6db74">&#34;comedy&#34;</span>, <span style="color:#e6db74">&#34;gaming&#34;</span>, <span style="color:#e6db74">&#34;sports&#34;</span>, <span style="color:#e6db74">&#34;books-and-magazines&#34;</span>, <span style="color:#e6db74">&#34;languages-and-foreign-cultures&#34;</span>, <span style="color:#e6db74">&#34;design-and-creative&#34;</span>, <span style="color:#e6db74">&#34;internet-and-technology&#34;</span>, <span style="color:#e6db74">&#34;natural-science&#34;</span>, <span style="color:#e6db74">&#34;humanities-and-social-sciences&#34;</span>] }
</span></span><span style="display:flex;"><span>      - { <span style="color:#f92672">label</span>: <span style="color:#e6db74">&#34;Body&#34;</span><span style="color:#f92672">, name</span>: <span style="color:#e6db74">&#34;body&#34;</span><span style="color:#f92672">, widget</span>: <span style="color:#e6db74">&#34;markdown&#34;</span> }
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">summary</span>: <span style="color:#e6db74">&#34;{{date | date(&#39;YYYY-MM-DD&#39;)}} | {{body | truncate(280, &#39;...&#39;)}}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">sort</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">field</span>: <span style="color:#e6db74">&#34;date&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">direction</span>: <span style="color:#e6db74">&#34;desc&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#34;work&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">label</span>: <span style="color:#e6db74">&#34;Work&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">folder</span>: <span style="color:#e6db74">&#34;content/work&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">create</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">slug</span>: <span style="color:#e6db74">&#34;{{fields.slug}}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">media_folder</span>: <span style="color:#e6db74">&#34;/static/images/work/{{fields.slug}}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">public_folder</span>: <span style="color:#e6db74">&#34;/images/work/{{fields.slug}}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">fields</span>:
</span></span><span style="display:flex;"><span>      - { <span style="color:#f92672">label</span>: <span style="color:#e6db74">&#34;Title&#34;</span><span style="color:#f92672">, name</span>: <span style="color:#e6db74">&#34;title&#34;</span><span style="color:#f92672">, widget</span>: <span style="color:#e6db74">&#34;string&#34;</span> }
</span></span><span style="display:flex;"><span>      - { <span style="color:#f92672">label</span>: <span style="color:#e6db74">&#34;Date&#34;</span><span style="color:#f92672">, name</span>: <span style="color:#e6db74">&#34;date&#34;</span><span style="color:#f92672">, widget</span>: <span style="color:#e6db74">&#34;datetime&#34;</span><span style="color:#f92672">, date_format</span>: <span style="color:#e6db74">&#34;YYYY-MM-DD&#34;</span><span style="color:#f92672">, time_format</span>: <span style="color:#66d9ef">false</span> }
</span></span><span style="display:flex;"><span>      - { <span style="color:#f92672">label</span>: <span style="color:#e6db74">&#34;Slug&#34;</span><span style="color:#f92672">, name</span>: <span style="color:#e6db74">&#34;slug&#34;</span><span style="color:#f92672">, widget</span>: <span style="color:#e6db74">&#34;string&#34;</span> }
</span></span><span style="display:flex;"><span>      - { <span style="color:#f92672">label</span>: <span style="color:#e6db74">&#34;Image&#34;</span><span style="color:#f92672">, name</span>: <span style="color:#e6db74">&#34;image&#34;</span><span style="color:#f92672">, widget</span>: <span style="color:#e6db74">&#34;image&#34;</span> }
</span></span><span style="display:flex;"><span>      - { <span style="color:#f92672">label</span>: <span style="color:#e6db74">&#34;Body&#34;</span><span style="color:#f92672">, name</span>: <span style="color:#e6db74">&#34;body&#34;</span><span style="color:#f92672">, widget</span>: <span style="color:#e6db74">&#34;markdown&#34;</span> }
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">summary</span>: <span style="color:#e6db74">&#34;{{date | date(&#39;YYYY-MM-DD&#39;)}} | {{title}}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">sort</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">field</span>: <span style="color:#e6db74">&#34;date&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">direction</span>: <span style="color:#e6db74">&#34;desc&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#34;shoulders-of-giants&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">label</span>: <span style="color:#e6db74">&#34;The shoulders of Giants&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">folder</span>: <span style="color:#e6db74">&#34;content/shoulders-of-giants&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">create</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">slug</span>: <span style="color:#e6db74">&#34;{{fields.slug}}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">fields</span>:
</span></span><span style="display:flex;"><span>      - { <span style="color:#f92672">label</span>: <span style="color:#e6db74">&#34;Topic&#34;</span><span style="color:#f92672">, name</span>: <span style="color:#e6db74">&#34;topic&#34;</span><span style="color:#f92672">, widget</span>: <span style="color:#e6db74">&#34;list&#34;</span>}
</span></span><span style="display:flex;"><span>      - { <span style="color:#f92672">label</span>: <span style="color:#e6db74">&#34;Body&#34;</span><span style="color:#f92672">, name</span>: <span style="color:#e6db74">&#34;body&#34;</span><span style="color:#f92672">, widget</span>: <span style="color:#e6db74">&#34;markdown&#34;</span> }
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">summary</span>: <span style="color:#e6db74">&#34;{{body | truncate(280, &#39;...&#39;)}}　　Topic {{topic}}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">sort</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">field</span>: <span style="color:#e6db74">&#34;body&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">direction</span>: <span style="color:#e6db74">&#34;asc&#34;</span>
</span></span></code></pre></div><h2 id="decap-cms-の落とし穴と実際のこのサイトの運用について">Decap CMS の落とし穴と、実際のこのサイトの運用について</h2>
<p>さて、これで理想的な個人ブログの運用体制が構築できた…と思っていたのだが、Decap CMS には大きな落とし穴があった。記事のテキストフィールドが、日本語入力に対応できていないのだ。漢字変換をしようとしたときにキャレットの位置がズレてしまい、正常に入力作業をすることができない。</p>
<p><a href="https://github.com/decaporg/decap-cms/issues/1347">Updating Slate editor to support Korean</a></p>
<p>どうやら Slate のバージョンが古いのが原因らしいく、プルリクは出ているようだがスルーされているっぽい。</p>
<p>（写真）
Issueが立っていたのでむなしくコメントを残しておいた。</p>
<p>なので、実際このサイトの運用は次のようになっている。</p>
<ul>
<li>UpNote でコンテンツ管理（UpNote はモバイル用のネイティブアプリが用意されている。）</li>
<li>更新するときは UpNote から DecapCMS にコピペ</li>
</ul>
<p>以前に比べれば格段に更新しやすくはなったものの、できればブラウザで完結するようにしたい。
もちろん、ヘッドレスCMSには他にも有力な候補があるのだが、Netlify との相性と、無料で使えるという条件で探すと選択肢はそれほど多くはない。また、できればスマホから更新ができるように、モバイル用のインターフェースが提供されているものがあるとなお嬉しい。次の休みにもう少し調べてみようと思う。</p>

            </article>
        

            <div class="pagination-buttons">
  
      <a href="/diary/an-encouragement-of-sampo/" class="pagination-button">
          <img src="/images/common/icon_left.svg" alt="">
          Prev
      </a>
  
  
</div>    

        </ul>
    </section>
</main>

<nav class="global-nav">
  <a href="/" class="global-nav__home"></a>
  <a href="/about" class="global-nav__about"></a>
  <a href="/work" class="global-nav__work"></a>
  <a href="/diary" class="global-nav__diary on"></a>
  <a href="/shoulders-of-giants" class="global-nav__think"></a>
</nav>


<p class="debug-info">Template : /layouts/diary/single.html</p>





    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
    <p class="debug-info">Template : /layouts/_default/baseof.html</p>
</body>
</html>
