<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8">
    <title>2025-05</title>

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/go.min.js"></script>
    <script>hljs.highlightAll();</script>

    <link rel="stylesheet" href="/css/main.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" type="image/x-icon" href="/images/common/favicon/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/common/favicon/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/common/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/images/common/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/images/common/favicon/favicon-192x192.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/common/favicon/apple-touch-icon.png">

    
    <meta property="og:title" content="2025-05">
    <meta property="og:description" content="One thing I can tell you is you got to be free!">
    <meta property="og:type" content="website">
    <meta property="og:url" content="http://localhost:1313/month/2025-05/">
    <meta property="og:image" content="http://localhost:1313/images/common/og-image.png">
    <meta property="og:site_name" content="ezeroms.com">
    <meta property="og:locale" content="ja_JP">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="2025-05">
    <meta name="twitter:description" content="One thing I can tell you is you got to be free!">
    <meta name="twitter:image" content="http://localhost:1313/images/common/og-image.png">

</head>
<body>
    <div class="layout-container">
        <aside class="layout-sidebar" aria-label="グローバルナビゲーション">
            <div class="sidebar">
  <div class="sidebar__main">
    <div class="sidebar__logo">
      <a href="/">
        <img src="/images/common/logo.svg" alt="ezeroms.com">
      </a>
      <button class="sidebar__minimize-btn" id="sidebar-minimize-btn" aria-label="サイドバーを最小化" data-tooltip="メニューを非表示にする">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
    </div>

    
    <nav class="sidebar__nav-group" aria-label="グローバルナビゲーション">
      <ul class="sidebar__nav">
        <li>
          <a class="" href="/about/">About</a>
        </li>
        <li>
          <a class="" href="/tweet/">Tweet</a>
        </li>
        <li>
          <a class="" href="/diary/">Diary</a>
        </li>
        <li>
          <a class="" href="/column/">Column</a>
        </li>
        <li>
          <a class="" href="/work/">Work</a>
        </li>
        
      </ul>
      
      <div class="sidebar__library">
        <h3 class="sidebar__library-heading">Library</h3>
        <ul class="sidebar__nav">
          <li>
            <a class="" href="/shoulders-of-giants/">The shoulders of Giants</a>
          </li>
          <li>
            <a class="" href="/chronicle/">Chronicle</a>
          </li>
          <li>
            <a class="" href="/ui-design-guidebook/">UI Design Guidebook</a>
          </li>
        </ul>
      </div>
    </nav>
  </div>
</div>


        </aside>

        <div class="layout-body">
            
            <div class="layout-header">
                
            </div>
            
            <div class="layout-main layout-main--with-tags">
                
                <main class="layout-main__content" id="main-content">
                    
    <div id="notification" class="notification">
    Link copied to clipboard!
</div>

    <section class="diary-main">
        <div class="diary-main__content">
            <ul class="article-container" id="article-container">

            <div class="article-item-heading">
                <div class="article-item-heading__label">
                    <p class="article-item-heading__label__p">
                        
                         Diary
                    </p>
                    
                    
                    
                    <h2 class="article-item-heading__label__h2">
                        2025-05
                    </h2>
                </div>

                
                <button class="article-item-heading__button" onclick="copyToClipboard()">
                    <img src="/images/common/icon_link.svg" alt="Get article url">
                </button>
                <script>
                    function copyToClipboard() {
                        const url = window.location.href;
                        navigator.clipboard.writeText(url).then(function() {
                            showNotification();
                        }, function(err) {
                            console.error('リンクの保存に失敗しました: ', err);
                        });
                    }
                    function showNotification() {
                        var notification = document.getElementById("notification");
                        notification.className = "notification show";
                        setTimeout(function() {
                            notification.className = notification.className.replace(" show", "");
                        }, 3000);
                    }
                </script>
                        
            </div>

            
            
            
            
            
                
                <article id="%E4%BA%BA%E3%81%A8ai%E3%81%AE%E9%96%A2%E4%BF%82%E6%80%A7%E3%82%92%E8%A8%AD%E8%A8%88%E3%81%97%E3%82%88%E3%81%86-embedding-/-copilot-/-agent-%E3%81%AE%E4%B8%89%E9%A1%9E%E5%9E%8B" class="article-item">
                    

                    <p class="date">2025-05-07</p>
                    <a href="http://localhost:1313/column/3-ai-model/">
                        <h1>人とAIの関係性を設計しよう　Embedding / Copilot / Agent の三類型</h1>
                    </a>

                    <p>自分が作るプロダクトの中で、人間とAIはどのような関係性を築くのか？</p>
<p>壮大なテーマに聞こえるかもしれないが、実はプロダクト開発における実務的な問いだと思っている。もう少し現場的にいえば、「人間に対して、AIをどのような位置に立たせて仕事をさせるか」ともいえるかもしれない。ユーザー体験やプロダクトの意味合いは、この設計次第で大きく変わってくる。</p>
<p>この問いに向き合うためのフレームとして、僕が最近出会って腑に落ちたものを紹介したい。中国のあるデザイン系メディアで紹介されていた「人間とAIの協働における三類型」という整理だ。以下の図は、そこで紹介されていたものを僕が翻訳し、わかりやすくするために少しだけ改変したものである。</p>
<div class="image-wrapper"><img src="/images/diary/3-ai-model/40.png" alt="出典：人人都是产品经理「AIGC智能推荐系统设计」"></div><p>この図では、人とAIが協働する際の関係性をEmbedding（裏方）、Copilot（共同作業者）、Agent（代理人）という三つの型で捉えている。タスクの進行プロセスを縦に示し、それぞれの協働スタイルを横に並べた形だ。</p>
<h3 id="embedding裏方aiが部分的に人間のタスクを補助するモード">Embedding（裏方）：AIが部分的に人間のタスクを補助するモード</h3>
<p>作業の大部分はユーザーが主導し、AIはその中の一部の工程、情報検索や判断材料の提示といった領域で、さりげなく手を貸す。ゴールの設計や意思決定、最終的な実行はあくまでユーザーが担っており、AIはタスクの断片にだけ「埋め込まれて」いる。たとえば、フォームの自動補完、スマートな並び替えの提案、画像の自動補正、検索時のキーワード補強などがその例だ。大抵の場合、ユーザーはAIを「操作している」という感覚すら持たないことも多く、なんとなく便利、くらいの感覚で使われている。</p>
<h3 id="copilot共同作業者aiが人間と並走し随時サポートや提案を行うモード">Copilot（共同作業者）：AIが人間と並走し、随時サポートや提案を行うモード</h3>
<p>作業の主導権はユーザーが持ちつつ、AIはその過程で「一緒に考える相手」として振る舞う。タスクの中で特定の処理を代わりに行うこともあるが、その成果物はユーザーの確認・修正を経て進められる。GitHub CopilotやNotion AIのように、ユーザーが言語化した意図を受け取り、それに応じたアシストをしてくれる例がこれにあたる。</p>
<h3 id="agent代理人ユーザーが目的を設定したあとaiがその達成に向けてタスクを分解し適切なリソースや手段を選びながら自律的に進めていくモード">Agent（代理人）：ユーザーが目的を設定したあと、AIがその達成に向けてタスクを分解し、適切なリソースや手段を選びながら自律的に進めていくモード</h3>
<p>ユーザーは起点のアクションと最終確認を担うが、途中の過程ではAIが代理人として意思決定し、進行する。AutoGPTのようなツールがこの例にあたり、ユーザーは「何をしたいか」を伝えるだけで、AIがステップを設計し実行していく。頼もしいけれど、ちょっと怖いと感じる人もいるかもしれない。SF映画ではだいたい人類を滅ぼしにかかってくる。</p>
<div class="image-wrapper"><img src="/images/diary/3-ai-model/43.png" alt=""></div><h6 id="heading">﻿</h6>
<p>この三類型の整理がよいのは、AIの能力の高さや技術的な洗練度ではなく、「協働の構造」にフォーカスしているところだ。僕は、プロダクトの本質はこの協働の構造にあって、AI自体の技術力はその上に乗っかってくるパワーのようなものだと思っている。パワーでの戦いは、資本力の高いところに勝つのは難しい。しかし協働の構造を工夫するところには、ベンチャーにも戦える余地があると思う。</p>
<p>プロダクトにAI機能を実装するときには、この図を参考にして、ユーザーとAIの間にどんな関係性を築いていくのかを十分に議論するようにしていきたい。この図は、その議論をふわふわとした抽象論に留めず、図面的設計的に捉えてチームで共有するための叩き台になるはずだ。</p>
<p>そうした議論の延長として「関係性のフェーズ移行を設計する」ということも考えられるだろう。新しい機能は最初Copilot型でユーザーと一緒に試行錯誤しながら信頼を得ていき、一定の慣れが生まれたタイミングでAgent的な動きを提案していく、というような段階的な設計の可能性だ。協働のあり方を、固定された型ではなく、関係性の成熟に応じてシフトするものとして捉えてみると、より実用的な設計ができる気がする。</p>
<p>また、「関係性を構築する」というのは、「継続的な視点を持つ」ということでもある。人間同士がそうであるように、関係性はある程度の時間の中で育っていくものだからだ。実際の関係構築というのは、ドラマの脚本のように設定を与えれば完了するわけではない。このことは、自分の身の回りの関係が、「最初の印象」なんかよりも「どう付き合い続けてきたか」の方が強く影響していることからも分かるだろう。特に、ある関係のあり方を意図的に目指すのであれば、より計画的な取り組みと、適時の調整作業が必要だ。</p>
<blockquote>
<p>関係性は持続され、反復されることによってのみ成立する。「関係性」とは一定の距離感と進入角度のことを指すのではなく、二者の接触によってその都度、距離感と進入角度が共創的に試行錯誤し続けられる「状態」のことを指すのだ。</p>
<p>（宇野常寛、2022『砂漠と異人たち』朝日新聞出版）</p>
<p>美涼は、それはそんなに難しくないという顔で、
「わかったってところから、また愛し直すんじゃないですか？　一回、愛したら終わりじゃなくて、長い時間の間に、何度も愛し直すでしょう？　色んなことが起きるから。」と言った。</p>
<p>（平野啓一郎、2018『ある男』文藝春秋）</p></blockquote>
<p>まだまだAI機能のデザインは始まったばかりなので、これからいろいろとAI搭載のプロダクトを作っていけば、より詳細な類型化もできるかもしれない。もとより人と他者の関係のあり方は一様ではないし、型通りのもので終わる話でもないだろう。AI機能を観察するときに「この機能は、人とAIをどのように協働させるものなのか」という問いを持つことで、僕たちはより実務的なデザイナーの目を養うことができると思う。</p>
<p>どうすればAIとの関係が、日々の営みに溶け込んで、自然にそこにあるものとして続いていくのか。使えば使うほど馴染んでいくような関係性は、どうしたら作ることができるのか。そんなことを話し合って設計された機能こそが、ユーザーに利便性以上のものをもたらし、プロダクトの価値を高めていくはずだ。</p>

            
                    <script>
                        document.addEventListener('DOMContentLoaded', function() {
                            document.querySelectorAll('.image-wrapper img').forEach(function(img) {
                                const altText = img.getAttribute('alt');
                                if (altText) {
                                    img.parentElement.setAttribute('data-alt', altText);
                                } else {
                                    console.log('alt属性が空のimgタグを検出しました');
                                    img.parentElement.classList.add('no-alt'); 
                                }
                            });
                        });
                    </script>

                    <div class="social-action">
                        <div class="social-action__left">
                            <div class="social-action__line">
                                <div class="social-action__line-icon"></div>
                                <a href="https://lin.ee/eVcRqAC" target="_blank">
                                    このブログの更新通知をLINEで受け取る
                                </a>
                            </div>
                        </div>
                        <div class="social-action__right">
                            <a href="https://twitter.com/intent/tweet?text=%e4%ba%ba%e3%81%a8AI%e3%81%ae%e9%96%a2%e4%bf%82%e6%80%a7%e3%82%92%e8%a8%ad%e8%a8%88%e3%81%97%e3%82%88%e3%81%86%e3%80%80Embedding%20%2f%20Copilot%20%2f%20Agent%20%e3%81%ae%e4%b8%89%e9%a1%9e%e5%9e%8b&url=http%3a%2f%2flocalhost%3a1313%2fcolumn%2f3-ai-model%2f" target="_blank" class="social-action__x" data-show-count="false"></a>
                            <a href="http://b.hatena.ne.jp/entry/http://localhost:1313/column/3-ai-model/" target="_blank" class="social-action__hatena"></a>
                            
                        </div>
                    </div>
                </article>
                
                <article id="%E4%BB%8A%E6%97%A5%E3%81%AE%E3%83%8F%E3%82%A4%E3%83%A9%E3%82%A4%E3%83%88-2025/05/10" class="article-item">
                    

                    <p class="date">2025-05-09</p>
                    <a href="http://localhost:1313/diary/2025-05-10/">
                        <h1>今日のハイライト: 2025/05/10</h1>
                    </a>

                    <p>台湾といえば、やっぱり肉粽（ちまき）だと思う。</p>
<p>あの笹の香りともち米のずっしり感が、土地の空気と結びついている感じがする。台北だったら王記府城の肉粽が最高だ。</p>
<p>そして今日、初めて気づいたのだが……</p>
<div class="image-wrapper"><img src="/images/diary/2025-05-10/pxl_20250510_160558101.jpg" alt=""></div><p>肉粽、コンビニでふつうに売っていた。</p>
<p>さすが台湾すぎる……！</p>
<h6 id="heading">　﻿</h6>
<p>台湾のコンビニ飯でいうと、僕がめっちゃ好きなのが麻油鶏（マーヨージー）のおにぎりだ。</p>
<div class="image-wrapper"><img src="/images/diary/2025-05-10/pxl_20250510_160624014.jpg" alt=""></div><p>麻油鶏とは、台湾のスープ料理である。それがおにぎりの具材になっている。どうだ、混乱するだろう。</p>
<p>でも食べてみると、ちゃんと米の食感の中から麻油鶏の味がしてくる。いったい何が起きているのか分からない。戸惑いと感動が同時に襲ってくる。</p>
<h6 id="heading-1">　﻿</h6>
<p>稲田俊輔が、日本料理で「旨味」が重宝されるように、南インド料理では「マズ味」（酸味やエグ味）がうまく使われている、と言っていたが、僕は台湾で暮らして初めて「苦味っておいしいんだな」と感じるようになった。</p>
<p>そのことを強く実感した料理が二つある。その一つが麻油鶏だ。このおにぎりがおいしいのも、麻油鶏特有の薬膳の苦味が味わえるからだと思う。もう一つは忘れた。思い出したらまた書こう。</p>
<p>冬に食べる麻油鶏は最高だが（この冬、僕は抑えきれず週三ペースで麻油鶏を食べ、露骨に太った）今日くらいの暑さだとちょっと厳しい。そういうとき、お手軽に麻油鶏の味を楽しむためのものとして、このおにぎりは本当に大発明だと思う。マジで痩せる暇がない。</p>

            
                    <script>
                        document.addEventListener('DOMContentLoaded', function() {
                            document.querySelectorAll('.image-wrapper img').forEach(function(img) {
                                const altText = img.getAttribute('alt');
                                if (altText) {
                                    img.parentElement.setAttribute('data-alt', altText);
                                } else {
                                    console.log('alt属性が空のimgタグを検出しました');
                                    img.parentElement.classList.add('no-alt'); 
                                }
                            });
                        });
                    </script>

                    <div class="social-action">
                        <div class="social-action__left">
                            <div class="social-action__line">
                                <div class="social-action__line-icon"></div>
                                <a href="https://lin.ee/eVcRqAC" target="_blank">
                                    このブログの更新通知をLINEで受け取る
                                </a>
                            </div>
                        </div>
                        <div class="social-action__right">
                            <a href="https://twitter.com/intent/tweet?text=%e4%bb%8a%e6%97%a5%e3%81%ae%e3%83%8f%e3%82%a4%e3%83%a9%e3%82%a4%e3%83%88%3a%202025%2f05%2f10&url=http%3a%2f%2flocalhost%3a1313%2fdiary%2f2025-05-10%2f" target="_blank" class="social-action__x" data-show-count="false"></a>
                            <a href="http://b.hatena.ne.jp/entry/http://localhost:1313/diary/2025-05-10/" target="_blank" class="social-action__hatena"></a>
                            
                        </div>
                    </div>
                </article>
                
                <article id="%E4%BB%8A%E6%97%A5%E3%81%AE%E3%83%8F%E3%82%A4%E3%83%A9%E3%82%A4%E3%83%88-2025/05/17" class="article-item">
                    

                    <p class="date">2025-05-17</p>
                    <a href="http://localhost:1313/diary/2025-05-17/">
                        <h1>今日のハイライト: 2025/05/17</h1>
                    </a>

                    <p>岩首で、大石さんの田植えを手伝ってきた。</p>
<div class="image-wrapper"><img src="/images/diary/2025-05-17/1747488234398~2.jpg" alt=""></div><div class="image-wrapper"><img src="/images/diary/2025-05-17/1747488234325.jpg" alt=""></div><p>僕は農作業や庭仕事の類が昔からあまり好きじゃない。が、坐骨神経痛とヘルニアを同時にキメた高齢の友人のために、腹を括って鉛のように重たい腰を持ち上げて行ってきた。</p>
<p>台湾から帰国してまだ数日、じんわり疲労感が残る身体は、田んぼの泥に優しく沈み込む。</p>
<h6 id="heading">　﻿</h6>
<div class="image-wrapper"><img src="/images/diary/2025-05-17/pxl_20250517_081819295.jpg" alt=""></div><div class="image-wrapper"><img src="/images/diary/2025-05-17/1747488234273.jpg" alt="写真は晴れ間に撮っているので分かりづらいが、農作業はまあまあの雨の中で行われた。"></div><div class="image-wrapper"><img src="/images/diary/2025-05-17/pxl_20250517_082011860~2.jpg" alt=""></div><h6 id="heading-1">　﻿</h6>
<p>夜、浅井と海野と三人で麻雀を打った。日本で打つのは今年初めてだ。</p>
<p>台湾麻雀の癖が抜けず、なんだか随分とガサツな打ち回しになってしまった気がするが、三麻という懐の広いルールに甘えてなんとかプラスで終えることができた。</p>
<p>それにしても、卓についてるのは自分なのに、どこか他人が打っているのを後ろから眺めているような、ふわっとした感覚が終始あった。</p>
<video controls width="100%">
  <source src="https://ezeroms.com/images/diary/2025-05-17/output.mp4">
  お使いのブラウザでは動画を再生できません。
</video>
<h6 id="heading-2">　﻿</h6>
<p>浅井とは、年に一、二度、佐渡でしか会わない。たったそれだけの付き合いだが、わざわざ佐渡の山奥に来る同世代というだけで、妙なシンパシーがある。ニッチな推しが被ってるような感じだ。</p>
<p>去年の秋、僕は佐渡に向かう理由の半分くらいを「浅井に会うこと」に置いていた。中秋の島の静けさの中で、言葉を少しずつ渡し合いながら、何かしら確かめたかったんだと思う。浅井との対話にはそういう力がある。</p>
<p>ところが、いざ会ってみると彼は終始酒に酔っていて会話が成立せず、挙句、酒を飲まない僕に「人生の半分は損してる」と、テンプレのような泥酔口撃を繰り出してきた。最悪である。</p>
<p>正直かなりがっかりしてしまったので、今回一緒に佐渡で過ごそうという話になったとき、ついその件についてきつめの物言いをしてしまった。</p>
<p>浅井は酒量をぐっと控えてくれて、結果として穏やかでいい時間を過ごせた気がするのだけど、でもその裏に、彼なりの「抑え」があったのだとしたら、僕たちの関係性は少し無理のあるかたちになっていたのかもしれない。</p>
<p>田舎で酒飲みと過ごすときのいいやり方を、もう少し考えたい。</p>

            
                    <script>
                        document.addEventListener('DOMContentLoaded', function() {
                            document.querySelectorAll('.image-wrapper img').forEach(function(img) {
                                const altText = img.getAttribute('alt');
                                if (altText) {
                                    img.parentElement.setAttribute('data-alt', altText);
                                } else {
                                    console.log('alt属性が空のimgタグを検出しました');
                                    img.parentElement.classList.add('no-alt'); 
                                }
                            });
                        });
                    </script>

                    <div class="social-action">
                        <div class="social-action__left">
                            <div class="social-action__line">
                                <div class="social-action__line-icon"></div>
                                <a href="https://lin.ee/eVcRqAC" target="_blank">
                                    このブログの更新通知をLINEで受け取る
                                </a>
                            </div>
                        </div>
                        <div class="social-action__right">
                            <a href="https://twitter.com/intent/tweet?text=%e4%bb%8a%e6%97%a5%e3%81%ae%e3%83%8f%e3%82%a4%e3%83%a9%e3%82%a4%e3%83%88%3a%202025%2f05%2f17&url=http%3a%2f%2flocalhost%3a1313%2fdiary%2f2025-05-17%2f" target="_blank" class="social-action__x" data-show-count="false"></a>
                            <a href="http://b.hatena.ne.jp/entry/http://localhost:1313/diary/2025-05-17/" target="_blank" class="social-action__hatena"></a>
                            
                        </div>
                    </div>
                </article>
                
                <article id="%E4%BB%8A%E6%97%A5%E3%81%AE%E3%83%8F%E3%82%A4%E3%83%A9%E3%82%A4%E3%83%88-2025/05/18" class="article-item">
                    

                    <p class="date">2025-05-17</p>
                    <a href="http://localhost:1313/diary/2025-05-18/">
                        <h1>今日のハイライト: 2025/05/18</h1>
                    </a>

                    <p>昨日に引き続き、今日も朝から農作業。</p>
<p>早起きして張り切った甲斐もあり、昼過ぎには予定の工程を終えることができた。これで大石さんの田んぼは一通り完了、あとは補植を残すのみ。ひとまず助っ人としてのミッションは達成である。</p>
<div class="image-wrapper"><img src="/images/diary/2025-05-18/1747570297166.jpg" alt=""></div><div class="image-wrapper"><img src="/images/diary/2025-05-18/1747570297001.jpg" alt=""></div><h6 id="heading">　﻿</h6>
<p>午後は、佐渡島で音楽ライブができそうな場所を探して、いくつかの候補地を回った。Chooningで検討中の企画だ。<br>
<br>
なかでも良かったのが、椎崎諏訪神社の能舞台。</p>
<p>その名の通り能を演じる場所だが、ステージとしての風格もあるし、観客席もちゃんと取れそうなスペースがある。実際に音楽イベントで使われた実績もあるとのこと。両津港からも近くて、周囲の宿泊施設も充実している。</p>
<p>加茂湖を見下ろす高台にあって、奥の方からは夕日が湖面に沈むところも見える。うまくいけば、夕暮れと音楽とが重なる瞬間がつくれるかもしれない。</p>
<div class="image-wrapper"><img src="/images/diary/2025-05-18/pxl_20250518_080641650.jpg" alt=""></div><div class="image-wrapper"><img src="/images/diary/2025-05-18/pxl_20250518_075849752.jpg" alt=""></div><h6 id="heading-1">　﻿</h6>
<p>しかし、ちょうど視察を終えたあと、イベント実施のためにアテにしていた資金の話が立ち消えになったという報せが入った。</p>
<p>＼(^o^)／</p>

            
                    <script>
                        document.addEventListener('DOMContentLoaded', function() {
                            document.querySelectorAll('.image-wrapper img').forEach(function(img) {
                                const altText = img.getAttribute('alt');
                                if (altText) {
                                    img.parentElement.setAttribute('data-alt', altText);
                                } else {
                                    console.log('alt属性が空のimgタグを検出しました');
                                    img.parentElement.classList.add('no-alt'); 
                                }
                            });
                        });
                    </script>

                    <div class="social-action">
                        <div class="social-action__left">
                            <div class="social-action__line">
                                <div class="social-action__line-icon"></div>
                                <a href="https://lin.ee/eVcRqAC" target="_blank">
                                    このブログの更新通知をLINEで受け取る
                                </a>
                            </div>
                        </div>
                        <div class="social-action__right">
                            <a href="https://twitter.com/intent/tweet?text=%e4%bb%8a%e6%97%a5%e3%81%ae%e3%83%8f%e3%82%a4%e3%83%a9%e3%82%a4%e3%83%88%3a%202025%2f05%2f18&url=http%3a%2f%2flocalhost%3a1313%2fdiary%2f2025-05-18%2f" target="_blank" class="social-action__x" data-show-count="false"></a>
                            <a href="http://b.hatena.ne.jp/entry/http://localhost:1313/diary/2025-05-18/" target="_blank" class="social-action__hatena"></a>
                            
                        </div>
                    </div>
                </article>
                
                <article id="%E4%BB%8A%E6%97%A5%E3%81%AE%E3%83%8F%E3%82%A4%E3%83%A9%E3%82%A4%E3%83%88-2025/05/19" class="article-item">
                    

                    <p class="date">2025-05-18</p>
                    <a href="http://localhost:1313/diary/2025-05-19/">
                        <h1>今日のハイライト: 2025/05/19</h1>
                    </a>

                    <div class="image-wrapper"><img src="/images/diary/2025-05-19/cm4cyhfzubnrrkfa.jpg" alt=""></div><p>佐渡汽船の売店で、なんとなく手に取った笹団子がめちゃくちゃうまかった。</p>
<p>冷凍されたものを持ち歩いていたら自然解凍されたんだけど、それがよかったのかもしれない。</p>
<h6 id="heading">　﻿</h6>
<div class="image-wrapper"><img src="/images/diary/2025-05-19/pgtvtq7i0u3jw0bu.jpg" alt="Perchの中庭でエナドリをキメる海野"></div><div class="image-wrapper"><img src="/images/diary/2025-05-19/ycxsxmfg8tjhbbff.jpg" alt="佐和田を歩いていたら突然現れたどこでもドア"></div>
            
                    <script>
                        document.addEventListener('DOMContentLoaded', function() {
                            document.querySelectorAll('.image-wrapper img').forEach(function(img) {
                                const altText = img.getAttribute('alt');
                                if (altText) {
                                    img.parentElement.setAttribute('data-alt', altText);
                                } else {
                                    console.log('alt属性が空のimgタグを検出しました');
                                    img.parentElement.classList.add('no-alt'); 
                                }
                            });
                        });
                    </script>

                    <div class="social-action">
                        <div class="social-action__left">
                            <div class="social-action__line">
                                <div class="social-action__line-icon"></div>
                                <a href="https://lin.ee/eVcRqAC" target="_blank">
                                    このブログの更新通知をLINEで受け取る
                                </a>
                            </div>
                        </div>
                        <div class="social-action__right">
                            <a href="https://twitter.com/intent/tweet?text=%e4%bb%8a%e6%97%a5%e3%81%ae%e3%83%8f%e3%82%a4%e3%83%a9%e3%82%a4%e3%83%88%3a%202025%2f05%2f19&url=http%3a%2f%2flocalhost%3a1313%2fdiary%2f2025-05-19%2f" target="_blank" class="social-action__x" data-show-count="false"></a>
                            <a href="http://b.hatena.ne.jp/entry/http://localhost:1313/diary/2025-05-19/" target="_blank" class="social-action__hatena"></a>
                            
                        </div>
                    </div>
                </article>
                
                <article id="%E3%82%A4%E3%83%B3%E3%82%AF%E3%83%88%E3%83%A9%E3%83%83%E3%83%97inktrap" class="article-item">
                    

                    <p class="date">2025-05-22</p>
                    <a href="http://localhost:1313/column/inktrap/">
                        <h1>インクトラップ（Inktrap）</h1>
                    </a>

                    <p>「インクトラップ（Inktrap）」というタイポグラフィの技術に関するメモ。</p>
<div class="image-wrapper"><img src="https://i0.wp.com/zarmatype.com/wp-content/uploads/2024/12/Inktrap-Typeface-1.png?fit=1820%2C51095&amp;ssl=1" alt=""></div><h2 id="作成する際のコツ">作成する際のコツ</h2>
<p>インクトラップを効かせる箇所は、細くて、鋭くて、潰れやすいところ。要するに「詰まりそうなポイント」に余白を仕込むとそれっぽく見える。</p>
<ul>
<li>内側の鋭角コーナー：ストローク同士がぐっと狭くなる部分。たとえば、セリフと縦線が交わる接合点など。</li>
<li>終筆（ターミナル）の先端：細い線がふっと途切れる箇所（細ければ細いほど印刷時に潰れやすい）。ここにほんの少し切り欠きを入れると、線が残ることになる。</li>
<li>セリフの付け根：水平のセリフと縦のストロークがぶつかる部分。細くなればなるほどインクのにじみで潰れやすくなるので、ここも空間を残しておく。</li>
<li>ストロークの交差点：「×」とか「＋」のような、線が中央でクロスするところ。見た目が黒く濁りがちなので、中心にわずかに隙間を入れる。</li>
<li>細いハネやカーブの端：筆記体っぽい書体で、カーブが直線に移る細いところ。</li>
</ul>
<h2 id="メモ">メモ</h2>
<p>インクトラップとは、文字の角の部分や接合部などにあらかじめ「へこみ」を設けておくことで、印刷時にインクがにじんでも、視覚的なバランスが保たれるようにするデザイン技法。とくに小さいサイズや粗い紙に印刷することを想定したフォントでは、文字が潰れてしまわないよう、あらかじめ余白を確保しておく必要があった。その発想から生まれたのがインクトラップである。</p>
<p>現代の高解像度ディスプレイではこのような工夫は不要だが、逆に「意図的にインクトラップを残す／見せる」というデザインが登場している。かつての「印刷のための工夫」が、いまは「造形的な魅力」として再解釈されている点がおもしろい。</p>
<div class="image-wrapper"><img src="/images/diary/inktrap/krjwfglqe6fw9byvhdb2.png" alt=""></div><div class="image-wrapper"><img src="/images/diary/inktrap/m6uj7ig8micd6b3kbaaf.webp" alt=""></div><div class="image-wrapper"><img src="/images/diary/inktrap/gnv48tawdxjvwngk5kj2.webp" alt=""></div><div class="image-wrapper"><img src="/images/diary/inktrap/dskwrryz74k7pncm7fjb.webp" alt=""></div><div class="image-wrapper"><img src="/images/diary/inktrap/e3vlvbkny9xnnytkxjnt.webp" alt=""></div><div class="image-wrapper"><img src="/images/diary/inktrap/tuo79zhmuipiw03lzwti.webp" alt=""></div><h6></h6>
<p>デザインにおいて、「かつての制約が生んだ造形」が「いまの美意識」に読み替えられる、というのはよくあることで、同じようにフォントでいえば、セリフ（もともとは金属活字の筋の弱い細線を補強するための「足」だったが、いまはクラシックさや安定感を象徴する装飾要素になっている）や、和文フォントのウロコ（筆で書く際の運筆の名残だが、いまでは和風の空気感を醸す装飾要素になっている）がそうだし、Webやアプリのデザインでよく採用されるグリッドレイアウトも、かつての組版や紙面整理の都合から生まれた構造が現在になって「モダンデザインの骨格美」として愛され、再活用されているものだ。</p>
<p>近過去を採用したものでいえば、Y2K（1990年代後半〜2000年代前半の限られた3D表現やCG技術、Webの表示制限が生んだチープな未来感が、いまでは懐かしさとフィクショナルな未来像のミックスとして再評価されている）や<a href="https://dribbble.com/search/pixel-art">ピクセルアート</a>、<a href="https://youtu.be/SiTazCUPBGM">チップチューン</a>なども挙げられる。</p>
<p><a href="https://www.youtube.com/watch?v=SiTazCUPBGM">https://www.youtube.com/watch?v=SiTazCUPBGM</a></p>
<h6></h6>
<p>エンジニアのスキルというのは、一度身につけた技術が数年後もそのまま使えるとは限らず、むしろ過去の知識が通用しなくなることのほうが多い。だからこそ、常に学び直しが求められるし、若い世代がベテランを凌駕するチャンスがあったり、その延長線上にベンチャーの勝機があったりもする。</p>
<p>つまり、不要になった技術的な工夫（iモード向けのサイト構築とか、Flash制作、IEへの個別対応とか……うっ、頭が……）というのはどんどん積み重なっていくわけだが、でも、そうした過去の制約下で生まれた工夫をあらためて掘り起こし、技術的な意味は失われても装飾的な意味で再利用する、ということができるのはデザイナーなんじゃないかと思う。</p>
<p>いったん役目を終えた技術を、意匠としてもう一度連れてきて、再解釈の文脈に乗せる。むしろ、技術が意味を失ってからのほうが、デザインとしては面白くなることもあるかもしれない。こういうところはまさにデザイナーの腕の見せどころだろう。</p>
<p>技術にもある程度詳しいデザイナーとして中年に差しかかるいま、こういう視点はこれからずっと使えるんじゃないか……と、思ったりしている。</p>
<h2 id="参考">参考</h2>
<ul>
<li><a href="https://zarmatype.com/inktrap-fonts-and-typefaces/">Cutting Corners: Exploring the Unique Charm of Inktrap Fonts and Typefaces</a></li>
<li><a href="https://cba-design.com/italy/en/insights/ink-traps/">Ink Traps</a></li>
</ul>

            
                    <script>
                        document.addEventListener('DOMContentLoaded', function() {
                            document.querySelectorAll('.image-wrapper img').forEach(function(img) {
                                const altText = img.getAttribute('alt');
                                if (altText) {
                                    img.parentElement.setAttribute('data-alt', altText);
                                } else {
                                    console.log('alt属性が空のimgタグを検出しました');
                                    img.parentElement.classList.add('no-alt'); 
                                }
                            });
                        });
                    </script>

                    <div class="social-action">
                        <div class="social-action__left">
                            <div class="social-action__line">
                                <div class="social-action__line-icon"></div>
                                <a href="https://lin.ee/eVcRqAC" target="_blank">
                                    このブログの更新通知をLINEで受け取る
                                </a>
                            </div>
                        </div>
                        <div class="social-action__right">
                            <a href="https://twitter.com/intent/tweet?text=%e3%82%a4%e3%83%b3%e3%82%af%e3%83%88%e3%83%a9%e3%83%83%e3%83%97%ef%bc%88Inktrap%ef%bc%89&url=http%3a%2f%2flocalhost%3a1313%2fcolumn%2finktrap%2f" target="_blank" class="social-action__x" data-show-count="false"></a>
                            <a href="http://b.hatena.ne.jp/entry/http://localhost:1313/column/inktrap/" target="_blank" class="social-action__hatena"></a>
                            
                        </div>
                    </div>
                </article>
                
                <article id="mattermost%E3%82%92%E3%82%BB%E3%83%AB%E3%83%95%E3%83%9B%E3%82%B9%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%99%E3%82%8B" class="article-item">
                    

                    <p class="date">2025-05-22</p>
                    <a href="http://localhost:1313/column/mattermost/">
                        <h1>Mattermostをセルフホスティングする</h1>
                    </a>

                    <div class="image-wrapper"><img src="/images/diary/mattermost/47.png" alt=""></div><h2 id="mattermostとは">Mattermostとは</h2>
<p>Mattermostは、Slackに似たUIを持つ、オープンソースのコラボレーションツールだ。</p>
<p>自分たちでサーバーを用意して運用する「セルフホスティング」に対応しており、ユーザー数や機能に応じて課金されることなく自由に使うことができる。すごい。これでSlack重税ともおさらばや！！</p>
<p><a href="https://mattermost.com/">https://mattermost.com/</a></p>
<h6 id="heading">　﻿</h6>
<div class="image-wrapper"><img src="/images/diary/mattermost/44.png" alt="Slack重税 2025年5月現在"></div><h2 id="mattermostセルフホスティングでできること">Mattermost（セルフホスティング）でできること</h2>
<ul>
<li>基本的なチャンネルベースのチャット（Slackと同様のUI）</li>
<li>ダイレクトメッセージ</li>
<li>チャンネルの公開設定（オープンチャンネル or プライベートチャンネル）</li>
<li>スレッド形式での返信</li>
<li>メンション @here, @channel, @username など</li>
<li>画像・PDFなどの添付＆プレビュー</li>
<li>iOS / Androidアプリあり（Mattermost公式）</li>
<li>投稿内でのMarkdown記法対応</li>
<li>Bot / Webhook: Incoming / Outgoing webhookあり</li>
<li>Plugin / Integration: Trello、GitLab、Jiraなどの連携プラグインあり</li>
</ul>
<h2 id="mattermostセルフホスティングでできないこと">Mattermost（セルフホスティング）でできないこと</h2>
<ul>
<li>音声通話: Slackのハドルのようなものは標準では非搭載（プラグインが必要）</li>
<li>画面共有: 上記のプラグインを使っても画面共有はできない</li>
<li>SAML / LDAP: Enterprise Editionならできるっぽい</li>
<li>監査ログ / EMM連携: Enterprise Editionならできるっぽい</li>
</ul>
<h6 id="heading-1">　﻿</h6>
<p>Slackの利用料を払うのが難しい規模のプロジェクトでは、Discordが使われることが多いと思う。</p>
<p>ただ、個人的にはDiscordのスレッド返信がどうにも使いづらく、結果としてテキストでのやり取りが整然と進められないのがずっと気になっていた。Mattermostではその点がしっかり解消されており、チャンネル内での会話の整理がしやすそうという印象。一方で、Discordのような「ゆるくつながる」音声通話のスタイルを大事にしたい場合には、Mattermostは少し堅すぎるというか、そういう用途にはあまり向いていない。</p>
<p>「本当はSlackのようなスタイルのコミュニケーションをしたいのだけど、仕方なくDiscordを使っている」というようなプロジェクトには、Mattermostはちょうどよい選択肢になると思う。</p>
<h6 id="heading-2">　﻿</h6>
<p>早速環境を用意してみたので、以下作業メモ。</p>
<h2 id="1-サーバーを用意する">1. サーバーを用意する</h2>
<p>さくらのVPSで 4Gプランを契約（記事執筆時で月額3,960円。年払いだともう少し安くなる）。</p>
<p>OSはUbuntu 22.04を選択。IPアドレスが払い出される。</p>
<p><a href="https://vps.sakura.ad.jp/">https://vps.sakura.ad.jp/</a></p>
<div class="image-wrapper"><img src="/images/diary/mattermost/45.png" alt=""></div><h6 id="heading-3">﻿</h6>
<p>契約後、コントロールパネルにアクセスしてサーバーを起動</p>
<p><a href="https://secure.sakura.ad.jp/vps/servers">https://secure.sakura.ad.jp/vps/servers</a></p>
<h2 id="2-sshでログインしてセットアップ開始">﻿2. SSHでログインしてセットアップ開始</h2>
<pre tabindex="0"><code>ssh root@&lt;VPSのIPアドレス&gt;
</code></pre><p>最初に自動生成されたパスワードを使ってログイン</p>
<h2 id="3-初期設定dockerの導入">3. 初期設定＆Dockerの導入</h2>
<pre tabindex="0"><code># パッケージ情報を更新
sudo apt update &amp;&amp; sudo apt upgrade -y

# Dockerとdocker-composeをインストール
sudo apt install -y docker.io docker-compose

# Dockerを自動起動するように設定
sudo systemctl enable docker
</code></pre><h2 id="4-mattermost用ディレクトリの作成">4﻿. Mattermost用ディレクトリの作成</h2>
<pre tabindex="0"><code>sudo mkdir -p /opt/mattermost
cd /opt/mattermost
</code></pre><h2 id="5-docker-composeyml-の作成">5. docker-compose.yml の作成</h2>
<pre tabindex="0"><code>sudo nano docker-compose.yml
</code></pre><pre tabindex="0"><code>version: &#34;3&#34;

services:
  db:
    image: postgres:13
    restart: always
    environment:
      POSTGRES_USER: mmuser
      POSTGRES_PASSWORD: mmuser_password
      POSTGRES_DB: mattermost
    volumes:
      - ./volumes/db:/var/lib/postgresql/data

  app:
    image: mattermost/mattermost-team-edition
    restart: always
    ports:
      - &#34;8065:8065&#34;
    environment:
      MM_SQLSETTINGS_DRIVERNAME: postgres
      MM_SQLSETTINGS_DATASOURCE: postgres://mmuser:mmuser_password@db:5432/mattermost?sslmode=disable
      MM_SERVICESETTINGS_SITEURL: http://&lt;VPSのIPアドレス&gt;:8065
    volumes:
      - ./volumes/app/mattermost:/mattermost/data
    depends_on:
      - db
</code></pre><p>nanoの保存コマンド: Ctrl + O → Enter → Ctrl + X</p>
<h2 id="6-コンテナの起動">6. コンテナの起動</h2>
<pre tabindex="0"><code>sudo docker-compose up -d
</code></pre><h2 id="7-サーバーのパケットフィルターを設定">7. サーバーのパケットフィルターを設定</h2>
<p>ポート 8065 でアクセスしたいので、パケットフィルターを設定する。ついでにこのあと必要なポートも登録しておく。</p>
<div class="image-wrapper"><img src="/images/diary/mattermost/48.png" alt=""></div><h2 id="8-動作確認">8. 動作確認</h2>
<p>ブラウザからVPSのIPアドレスを直叩きしてアクセス！</p>
<p><a href="http://160.16.197.152:8065">http://160.16.197.152:8065</a></p>
<div class="image-wrapper"><img src="/images/diary/mattermost/49.png" alt=""></div><h2 id="9-サブドメインの割り当て">9. サブドメインの割り当て</h2>
<p>ドメイン管理サービスでDNS設定</p>
<pre tabindex="0"><code>host: chat
type: A
data: 160.16.197.152
</code></pre><p>Google Domains亡きあと、惰性でSquarespaceを使い続けているけれど、ずっとCloudflare Registrarに移行したいと思っている。（こういう地味な作業に腰が上がらなくなるの、確実に加齢の兆候だと思う。）</p>
<h2 id="10-nginxでリバースプロキシを設定">10. Nginxでリバースプロキシを設定</h2>
<p>Mattermostのポート8065番を、標準の80番/443番（HTTPS）に乗せかえる必要がある。</p>
<p>Let’s Encryptは、ポート80（HTTP）を使って認証するため、Mattermost が直接 8065番で動いてると認証できない。そこで、Nginxで80番を受付けてMattermostに中継（proxy）する形を取る。</p>
<pre tabindex="0"><code>sudo apt install nginx
sudo nano /etc/nginx/sites-available/mattermost
</code></pre><pre tabindex="0"><code>server {
    listen 80;
    server_name chat.chooning.app;

    location / {
        proxy_pass http://localhost:8065;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
</code></pre><h6 id="heading-4">﻿</h6>
<p>有効化</p>
<pre tabindex="0"><code># sites-available に置いた設定ファイルを sites-enabled にシンボリックリンクで追加
sudo ln -s /etc/nginx/sites-available/mattermost /etc/nginx/sites-enabled/

# 設定ファイルの文法チェック
sudo nginx -t

# Nginxの再読み込み（設定反映）
sudo systemctl reload nginx
</code></pre><h6 id="heading-5">﻿</h6>
<p>SSL化（HTTPS対応）</p>
<pre tabindex="0"><code># certbot（証明書取得ツール）と nginx連携用のプラグインをインストール
sudo apt install certbot python3-certbot-nginx

# chat.chooning.app ドメインに対してSSL証明書を取得し、
# Nginxの設定に自動で組み込む（ポート443対応も自動設定される）
sudo certbot --nginx -d chat.chooning.app
</code></pre><p>メールアドレス入力、利用規約に同意、リダイレクト（HTTP→HTTPS）を Yes に。</p>
<h2 id="11-動作確認">11. 動作確認</h2>
<p>割り当てたドメインにブラウザでアクセスして確認</p>
<p><a href="http://chat.chooning.app">http://chat.chooning.app</a></p>

            
                    <script>
                        document.addEventListener('DOMContentLoaded', function() {
                            document.querySelectorAll('.image-wrapper img').forEach(function(img) {
                                const altText = img.getAttribute('alt');
                                if (altText) {
                                    img.parentElement.setAttribute('data-alt', altText);
                                } else {
                                    console.log('alt属性が空のimgタグを検出しました');
                                    img.parentElement.classList.add('no-alt'); 
                                }
                            });
                        });
                    </script>

                    <div class="social-action">
                        <div class="social-action__left">
                            <div class="social-action__line">
                                <div class="social-action__line-icon"></div>
                                <a href="https://lin.ee/eVcRqAC" target="_blank">
                                    このブログの更新通知をLINEで受け取る
                                </a>
                            </div>
                        </div>
                        <div class="social-action__right">
                            <a href="https://twitter.com/intent/tweet?text=Mattermost%e3%82%92%e3%82%bb%e3%83%ab%e3%83%95%e3%83%9b%e3%82%b9%e3%83%86%e3%82%a3%e3%83%b3%e3%82%b0%e3%81%99%e3%82%8b&url=http%3a%2f%2flocalhost%3a1313%2fcolumn%2fmattermost%2f" target="_blank" class="social-action__x" data-show-count="false"></a>
                            <a href="http://b.hatena.ne.jp/entry/http://localhost:1313/column/mattermost/" target="_blank" class="social-action__hatena"></a>
                            
                        </div>
                    </div>
                </article>
                
                <article id="%E4%BB%8A%E6%97%A5%E3%81%AE%E3%83%8F%E3%82%A4%E3%83%A9%E3%82%A4%E3%83%88-2025/05/24" class="article-item">
                    

                    <p class="date">2025-05-23</p>
                    <a href="http://localhost:1313/diary/2025-05-24/">
                        <h1>今日のハイライト: 2025/05/24</h1>
                    </a>

                    <p>赤レンガ倉庫のテラス席で、Greenroomの音漏れを聞きながら作業していた。海風に乗って届くベース音がちょうどよくて、結構な特等席だ。</p>
<div class="image-wrapper"><img src="/images/diary/2025-05-24/greenroom.png" alt=""></div><div class="image-wrapper"><img src="/images/diary/2025-05-24/pxl_20250524_083049794.jpg" alt="RIP SLYME全部名曲だなーーーと満面の笑みでパソコンに向かうクマガイさん"></div><h6 id="heading">﻿</h6>
<p>このGreenroomに参加するため、京都からふみちゃんがやってきたのだが、昨夜、駅からうちに来るまでの間につまずいて顔面を強打し、なんと前歯が折れてしまった。「欠けた」のではなく、まさにバキリと「折れた」のである。痛すぎる。</p>
<p>合流したときには顔面血まみれで、思わず2メートルほどのけぞってしまった。「駅まで迎えに行くよ」と僕が言っていたのに手が離せず、一人で来てもらったタイミングでの出来事だったので申し訳なさがすごい。</p>
<p>それでもふみちゃんは今朝から歯医者及び外科の治療を受け、アンパンマンの絆創膏を顔に貼って音に合わせて踊っていた。愛と勇気の健気なミュージック・ラバーである。ジャムおじさんに新しい顔を投げてもらいたい</p>
<div class="image-wrapper"><img src="/images/diary/2025-05-24/pxl_20250524_072832002.jpg" alt=""></div><h6 id="heading-1">　﻿</h6>
<div class="image-wrapper"><img src="/images/diary/2025-05-24/fire.jpg" alt="夕方、マリンウォークの向こうから突然「ドン！」と花火が上がった"></div><h6 id="heading-2">　﻿</h6>



  
  
  
  
  <iframe src="https://open.spotify.com/embed/track/5NsOTUsqq8rjmtCfYzUZL2"
      width="100%"
      height="152"
      frameborder="0"
      allowtransparency="true"
      allow="encrypted-media"
      class="spotify"></iframe>



            
                    <script>
                        document.addEventListener('DOMContentLoaded', function() {
                            document.querySelectorAll('.image-wrapper img').forEach(function(img) {
                                const altText = img.getAttribute('alt');
                                if (altText) {
                                    img.parentElement.setAttribute('data-alt', altText);
                                } else {
                                    console.log('alt属性が空のimgタグを検出しました');
                                    img.parentElement.classList.add('no-alt'); 
                                }
                            });
                        });
                    </script>

                    <div class="social-action">
                        <div class="social-action__left">
                            <div class="social-action__line">
                                <div class="social-action__line-icon"></div>
                                <a href="https://lin.ee/eVcRqAC" target="_blank">
                                    このブログの更新通知をLINEで受け取る
                                </a>
                            </div>
                        </div>
                        <div class="social-action__right">
                            <a href="https://twitter.com/intent/tweet?text=%e4%bb%8a%e6%97%a5%e3%81%ae%e3%83%8f%e3%82%a4%e3%83%a9%e3%82%a4%e3%83%88%3a%202025%2f05%2f24&url=http%3a%2f%2flocalhost%3a1313%2fdiary%2f2025-05-24%2f" target="_blank" class="social-action__x" data-show-count="false"></a>
                            <a href="http://b.hatena.ne.jp/entry/http://localhost:1313/diary/2025-05-24/" target="_blank" class="social-action__hatena"></a>
                            
                        </div>
                    </div>
                </article>
                
                <article id="hugo-v0.125%E4%BB%A5%E9%99%8D%E3%81%A7-_index.md-%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%9F%E3%82%BB%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%83%9A%E3%83%BC%E3%82%B8%E3%81%8C%E8%A1%A8%E7%A4%BA%E3%81%95%E3%82%8C%E3%81%AA%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E4%BB%B6" class="article-item">
                    

                    <p class="date">2025-05-24</p>
                    <a href="http://localhost:1313/column/hugo-section-page-not-rendering/">
                        <h1>Hugo v0.125以降で _index.md を使ったセクションページが表示されなくなった件</h1>
                    </a>

                    <p>Hugoでは、<code>content/about/_index.md</code>  のようなファイルを配置することで、「about」というセクションのトップページを作ることができる。WordPressでいえばカスタム投稿タイプのアーカイブページ（一覧ページ）に近い仕組みだ。セクション全体の紹介や記事一覧に使われるページで、Hugoの用語では「セクションページ（Section Page）」または「ブランチページ（Branch Page）」と呼ばれている。</p>
<p>例えば、僕のサイトでは、</p>
<ul>
<li><code>ezeroms.com/about/about/</code></li>
<li><code>ezeroms.com/about/work/</code> </li>
<li><code>ezeroms.com/about/diary/</code> </li>
<li><code>ezeroms.com/about/shoulders-of-giants/</code> </li>
</ul>
<p>といったURLで表示されるページがそれにあたる。</p>
<p>で。今日このサイトを更新していたら、それらのセクションページが突如表示されなくなった。この記事では、その原因と解決方法を記録しておく。</p>
<h2 id="問題の背景">問題の背景</h2>
<p>Hugoでは、contentディレクトリ以下にあるMarkdownファイルが、layouts以下にあるテンプレートによってHTMLに変換（＝レンダリング）される。</p>
<p>具体的には、以下のような構成だ。</p>
<pre tabindex="0"><code>content/
  about/
    _index.md
  diary
    _index.md
  shoulders-of-giants
    _index.md
  work
    _index.md
  
layouts/
  about/
    index.html
  diary
    index.html
  shoulders-of-giants
    index.html
  work
    index.html
</code></pre><h6 id="heading">　﻿</h6>
<p>content/about/_index.md</p>
<pre tabindex="0"><code>---
title: &#34;About&#34;
layout: &#34;index&#34;
---

ここにコンテンツを書く
</code></pre><h6 id="heading-1">　﻿</h6>
<p>layouts/about/index.html</p>
<pre tabindex="0"><code>&lt;section&gt;
  &lt;article&gt;
   {{ .Content }}
  &lt;/article&gt;
&lt;/section&gt;
</code></pre><p>このように、Markdown側では <code>layout: &quot;index&quot;</code>  を指定し、Hugoはそのレイアウトに従ってHTMLを生成してくれる。つまり、コンテンツは.mdファイルに書き、構造や見た目は.htmlテンプレートに記述することで、Markdownさえ書ければWebサイトが更新できるようになる。</p>
<p>この仕組みによって、例えばDecapCMSのようなヘッドレスCMSを使えば、mdファイルの編集だけでサイトの更新が可能になる。出力されるのはあくまで静的な html ファイルだが、裏側では動的にCMSを運用しているような体験が得られるのだ。</p>
<h6 id="heading-2">　﻿</h6>
<p>しかし今回localでbuildしたところ、buildは正常に完了したものの、該当するセクションページのHTMLが生成されない（「意図したファイルが public/ 以下に出てこない」）という問題が発生した。</p>
<h2 id="原因hugoのアップデートでテンプレート解決が厳密化">原因：Hugoのアップデートでテンプレート解決が厳密化</h2>
<p>今回の原因は、Hugoの仕様変更（v0.125以降）によりテンプレートの解決ルールがより厳密になったことだった。最近Macを新しくした際にHugoも最新バージョン（v0.134.1）でインストールし直したため、この問題が表面化したのだろう。</p>
<p>以前のHugoでは、<code>_index.md</code>  に対して <code>layout: &quot;index&quot;</code>  を指定していても、なんとなく <code>layouts/about/index.html</code>  が使われていたのだが、最新のHugoではそのような曖昧な解決が効かなくなり、テンプレートは適切な名称でなければならなくなった。というか、そもそも僕は <code>index.html</code>  が適切な型名でないことを今回調べて初めて知った( ＾ω＾) </p>
<p><a href="https://discourse.gohugo.io/t/index-md-file-rendering-correctly-then-overwritten-by-default-single-html/52059">index.md file rendering correctly then overwritten by default single.html | Hugo Forums</a></p>
<h2 id="解決策テンプレートファイル名とレイアウト指定の変更">解決策：テンプレートファイル名とレイアウト指定の変更</h2>
<p>以下のように修正したらセクションページが表示されるようになったよ＼(^o^)／</p>
<h6 id="heading-3">　﻿</h6>
<p>テンプレートファイルのファイル名を変更</p>
<pre tabindex="0"><code># 修正前
layouts/
  about/
    index.html
  diary/
    index.html
  shoulders-of-giants/
    index.html
  work/
    index.html

# 修正後
layouts/
  about/
    list.html
  diary/
    list.html
  shoulders-of-giants/
    list.html
  work/
    list.html
</code></pre><h6 id="heading-4">　﻿</h6>
<p>Markdownファイル内のレイアウト指定を変更</p>
<pre tabindex="0"><code># 修正前
layout: &#34;index&#34;

# 修正後
layout: &#34;list&#34;
</code></pre>
            
                    <script>
                        document.addEventListener('DOMContentLoaded', function() {
                            document.querySelectorAll('.image-wrapper img').forEach(function(img) {
                                const altText = img.getAttribute('alt');
                                if (altText) {
                                    img.parentElement.setAttribute('data-alt', altText);
                                } else {
                                    console.log('alt属性が空のimgタグを検出しました');
                                    img.parentElement.classList.add('no-alt'); 
                                }
                            });
                        });
                    </script>

                    <div class="social-action">
                        <div class="social-action__left">
                            <div class="social-action__line">
                                <div class="social-action__line-icon"></div>
                                <a href="https://lin.ee/eVcRqAC" target="_blank">
                                    このブログの更新通知をLINEで受け取る
                                </a>
                            </div>
                        </div>
                        <div class="social-action__right">
                            <a href="https://twitter.com/intent/tweet?text=Hugo%20v0.125%e4%bb%a5%e9%99%8d%e3%81%a7%20_index.md%20%e3%82%92%e4%bd%bf%e3%81%a3%e3%81%9f%e3%82%bb%e3%82%af%e3%82%b7%e3%83%a7%e3%83%b3%e3%83%9a%e3%83%bc%e3%82%b8%e3%81%8c%e8%a1%a8%e7%a4%ba%e3%81%95%e3%82%8c%e3%81%aa%e3%81%8f%e3%81%aa%e3%81%a3%e3%81%9f%e4%bb%b6&url=http%3a%2f%2flocalhost%3a1313%2fcolumn%2fhugo-section-page-not-rendering%2f" target="_blank" class="social-action__x" data-show-count="false"></a>
                            <a href="http://b.hatena.ne.jp/entry/http://localhost:1313/column/hugo-section-page-not-rendering/" target="_blank" class="social-action__hatena"></a>
                            
                        </div>
                    </div>
                </article>
                
                <article id="%E4%BB%8A%E6%97%A5%E3%81%AE%E3%83%8F%E3%82%A4%E3%83%A9%E3%82%A4%E3%83%88-2025/05/26" class="article-item">
                    

                    <p class="date">2025-05-25</p>
                    <a href="http://localhost:1313/diary/2025-05-26/">
                        <h1>今日のハイライト: 2025/05/26</h1>
                    </a>

                    <p>KJと、鶴屋町に新しくできたスシローに行ってきた。</p>
<p>台湾から帰ってきて以来、回転寿司ばかり行っている。カウンターの向こうから次々に流れてくる小皿を思考停止で迎え撃ちたくなる日々が続いているのだ。</p>
<div class="image-wrapper"><img src="/images/diary/2025-05-26/pxl_20250526_122150264-edit.jpg" alt=""></div><h6 id="heading">﻿</h6>
<p>どうでもいい話だが、僕は大学生になるまで回転寿司に行ったことがなかった。</p>
<p>僕の両親は、回転寿司を寿司と認めていなかった。「こんなものを子どもに食べさせるなんてありえない」という、かなり強めのポリシーがあったように思う。ちなみにファミレスの類もNGだった。（そのため、僕が中学生で初めてひとり旅をしたとき、まず最初にしたことは「ファミレスに入って巨大なパフェを注文すること」だった。）</p>
<p>両親の頭の中では、「回転寿司 ＝ 本物の寿司の廉価版」みたいな構図があったのだと思う。でも、実際のところ（多くの人が体験的に知っているように）回転寿司は寿司の下位互換なんかではなく、まったく別の料理であり、別の体験であり、「外食エンタメ」として独自の進化を遂げた産業でさえある。</p>
<p>回転寿司で回っているのは寿司ではない。寿司に擬態した何かである。これは「本物の寿司に味が劣る」という話ではなく、位相の違いだ。</p>
<p>江戸前寿司が食文化としての伝統を継承する場だとすれば、回転寿司は外食エンタメの革新と最適化の場である。そこに求められているのは固定化された「寿司」の質を高めることではなく、「楽しくて、ついもう一皿取りたくなる工夫」なのだ。</p>
<p>たとえば、回転寿司のサーモンにはチーズが当然のような顔で乗っている。軍艦にはコーンマヨやツナマヨが詰められている。タルタルソースが惜しみなく盛られたえび天や、イベリコ豚、ローストビーフ、ハンバーグ寿司なんてのも回ってくる。逆輸入されたカルフォルニアロールや、韓国料理のキンパなど、他国の料理のエッセンスが無邪気に紛れ込んでいる。メニューには唐揚げやフライドポテト、ラーメン、ハンバーガー、たこ焼きなんてのもある。祭りの屋台を眺めているような気分だ。</p>
<p>プリン、コーヒーゼリー、ガトーショコラ、みたらし団子、フレッシュパインなど、甘味の世界も広がっている。突如パチンコ的演出が発動し、オモチャが転がり落ちてくる。飯を食っていたらカプセルトイがもらえるのである。もはや食事という行為が拡張されている。注文はタブレット、配達は非接触の専用レーンで高速到着するなど、衛生面やユーザー体験に配慮された技術のアプリケーションとしてもかなり成熟している。これはもう近代日本の食と遊びと技術が交差した、総合アミューズメント施設といったほうがいい。そこにあるのは格式ではない。発明なのだ。</p>
<p>したがって、僕の両親が回転寿司を「寿司の代用品」として拒んでいたのは、たぶん的外れだった。ただ、決して頭が固い方ではなく、こうした面白さが伝わる感性はあると思うので、いつか油断しているときに回転寿司に連れ込んでやりたいと思っている。</p>
<div class="image-wrapper"><img src="/images/diary/2025-05-26/54-1-.png" alt="画像寿司たのしー"></div><h6 id="heading-1">　﻿</h6>
<p>さて、寿司をつまみながら、KJからTikTokの「#founderstory」というハッシュタグの話を聞いた。</p>
<div class="image-wrapper"><img src="/images/diary/2025-05-26/image-47-1-.png" alt=""></div><p>#founderstory とは、スタートアップを立ち上げた人が「ハーイ！ 私の名前はイヴァンカ。先週Googleを辞めて新しいプロダクトを立ち上げたの」「身の回りにあるこんなf**kingな課題をどうしても解決したくなったからね」「今日から100日でこの課題を解決するサービスを育てていくから、その様子をみんなにシェアしていくね〜！」みたいなノリで投稿する、マーケティングを目的とした動画コンテンツに付けられるハッシュタグのことらしい。</p>
<p>まだ自分でちゃんと確認したわけではないのであまり分かったフリをしないようにはしておきたいが、とりあえず僕はこれを「物語消費的なものの一形態だな」と理解した。ナラティブのスナック化だなあ、などと思う。</p>
<div class="image-wrapper"><img src="/images/diary/2025-05-26/pxl_20250526_122121905.jpg" alt=""></div><video controls width="100%">
  <source src="https://ezeroms.com/images/diary/2025-05-26/founderstory.mp4">
</video>
<h6 id="heading-2">　﻿</h6>
<p>「AIが台頭してくる中で、『人（ニン）を売る』ことがますます重要になってくる」</p>
<p>「プロダクトにおける『人（ニン）の含有量』をどう増やすかなんだよ」</p>
<p>KJの持論には頷けるところが多い。たしかにその通りだろう。AIが機能を量産する時代には、つくった人間の顔つきや手触りが、判断材料としていっそう重要になるのだと思う。</p>
<h6 id="heading-3">﻿　</h6>
<p>僕はこの手の起業家の試行錯誤的ジャイアントキリング物語が大好きなので、それがたとえマーケティング用に巧妙に編集されたものであったとしても、けっこう好んで見てしまうと思う。もしKJのような友人がやっていたら、応援がてらフォローして、日々の進捗を楽しくウォッチするだろう。</p>
<p>ただ、それを自分がやるか（たとえばChooningのプロジェクトについて「100日間でやってみる」的な発信をするか）と問われると、たぶんやらない気がする。</p>
<p>僕も情報発信に無関心なわけではないし、言葉を届けようとする意志は持っているつもりだが、自分の主戦場はやはりこういうブログのような、ある程度まとまった文字量を使って、自分の考えや感覚を丁寧に差し出せる場所でやっていきたいと思っている。</p>
<h6 id="heading-4">﻿</h6>
<p>これはリアルなコミュニケーションにも通じるのだけど、SNSにおける「いいね！」ボタン的な賛意や同調、それから服屋の「こちらお似合いですね！」のような、言っている内容そのものよりも会話を円滑に進めるためだけに存在している言葉をどれだけもらっても、僕はあまり心が動かない。できればもう少し時間をかけて、相手がこちらの言葉を受け取り、それを自分の思考や感覚のなかに通した上で返してくれるようなやり取りのほうが、僕にとってはずっと心地いい。</p>
<p>思うに、僕が大事にしたいのは、情報の交換というよりも思考の共有なのだろう。その人自身の文脈を通じて構築された返答を受け取ったとき、ようやくそこに対話が生まれている気がする。お互いの価値観や語彙、ものの見方を一時的に借り合うような、相手の頭を通してもう一度自分の言葉に出会い直す、そういうコミュニケーションのあり方が好きだ。</p>
<p>もちろん、反射的なリアクションが悪いわけではないし、そこにはそこにしかない温度や励ましがある。けれど、自分の感受性のあり方として、そういったもので満たされる領域はあまり多くないのだと思う。</p>
<p>できることなら、「僕の言葉をどう受け取ったか」を、相手の論理や感情の構造ごと見せてもらえるような、そういうやり取りの中に身を置いていたい。</p>

            
                    <script>
                        document.addEventListener('DOMContentLoaded', function() {
                            document.querySelectorAll('.image-wrapper img').forEach(function(img) {
                                const altText = img.getAttribute('alt');
                                if (altText) {
                                    img.parentElement.setAttribute('data-alt', altText);
                                } else {
                                    console.log('alt属性が空のimgタグを検出しました');
                                    img.parentElement.classList.add('no-alt'); 
                                }
                            });
                        });
                    </script>

                    <div class="social-action">
                        <div class="social-action__left">
                            <div class="social-action__line">
                                <div class="social-action__line-icon"></div>
                                <a href="https://lin.ee/eVcRqAC" target="_blank">
                                    このブログの更新通知をLINEで受け取る
                                </a>
                            </div>
                        </div>
                        <div class="social-action__right">
                            <a href="https://twitter.com/intent/tweet?text=%e4%bb%8a%e6%97%a5%e3%81%ae%e3%83%8f%e3%82%a4%e3%83%a9%e3%82%a4%e3%83%88%3a%202025%2f05%2f26&url=http%3a%2f%2flocalhost%3a1313%2fdiary%2f2025-05-26%2f" target="_blank" class="social-action__x" data-show-count="false"></a>
                            <a href="http://b.hatena.ne.jp/entry/http://localhost:1313/diary/2025-05-26/" target="_blank" class="social-action__hatena"></a>
                            
                        </div>
                    </div>
                </article>
                
                <article id="mattermost%E3%81%AEwebsocket%E6%8E%A5%E7%B6%9A%E3%82%A8%E3%83%A9%E3%83%BC%E3%82%92%E8%A7%A3%E6%B1%BA%E3%81%97%E3%81%9F" class="article-item">
                    

                    <p class="date">2025-05-29</p>
                    <a href="http://localhost:1313/column/mattermost-websocket-error/">
                        <h1>MattermostのWebSocket接続エラーを解決した</h1>
                    </a>

                    <p>MattermostにBoards（旧・Focalboard）のプラグインを入れる作業をする過程で発生したエラーに関する備忘録。</p>
<ul>
<li><a href="https://developers.mattermost.com/contribute/more-info/focalboard/mattermost-boards-setup-guide/">Mattermost Boards plugin guide</a></li>
<li><a href="https://www.focalboard.com/">Focalboard</a></li>
</ul>
<h6 id="heading">﻿</h6>
<p>プラグインをインストールしてBoardsのUIが表示されたまではよかったのだが、その画面上部に次のようなエラーが表示された。</p>
<div class="image-wrapper"><img src="/images/diary/mattermost-websocket-error/tuv46xwmkyhxblz1cscp.png" alt=""></div><blockquote>
<p>WebSocket connection closed, connection interrupted.<br>
If this persists, check your server or web proxy configuration.</p></blockquote>
<p>チャンネル（プロジェクト）やタスクをクリックしても何も起きない。タスクの新規作成はできるが編集はできないなど、部分的にできることできないことがあり、明らかに壊れている様子でもある。いろいろと検証した結果、これは「Boardsのインターフェースは立ち上がっているが、WebSocket通信が失敗していて機能していない状態」だろうということが分かった。以下に対処方法を記録しておく。</p>
<h2 id="原因その1nginxの設定ミス">原因その1：NGINXの設定ミス</h2>
<p>まず、リバースプロキシとして動作しているNginxの設定がどのようになっているかを確認する。</p>
<p>※ Mattermostはデフォルトではポート8065番で動作しているが、それを <a href="https://chat.chooning.app">https://chat.chooning.app</a> のような独自ドメインで扱うには、外部からのリクエストをNginxで受け取り、Mattermost本体に転送する必要がある（＝リバースプロキシ）。</p>
<h6 id="heading-1">　﻿</h6>
<p>その設定が有効になっているかを確認するため、有効なサイト設定ファイルの一覧を表示。</p>
<pre tabindex="0"><code>ls -l /etc/nginx/sites-enabled/
</code></pre><p><code>/etc/nginx/sites-enabled/</code>  は、Nginxが読み込むサイト設定ファイルへのシンボリックリンクが置かれている場所。 <code>/etc/nginx/sites-available/</code> にある設定ファイルのうち、実際に有効にしたいものをシンボリックリンクとして <code>/etc/nginx/sites-enabled/</code> に格納することで、設定が反映されるようになる。</p>
<ul>
<li><code>/etc/nginx/sites-available/</code> ： すべてのNginx用の設定ファイルの本体を置いておく場所。まだ有効にはなっていない。</li>
<li><code>/etc/nginx/sites-enabled/</code> ：実際にNginxが読み込んで使う設定ファイルのシンボリックリンクを置く場所。ここにあるファイルだけが、Nginx起動時に読み込まれて反映される。</li>
</ul>
<h6 id="heading-2">　﻿</h6>
<p>実行結果。<code>mattermost</code> という名前の設定ファイルが <code>/etc/nginx/sites-available/mattermost</code>  からリンクされていることから、Mattermost用のNginx設定が有効になっていることが確認できる。</p>
<pre tabindex="0"><code>default -&gt; /etc/nginx/sites-available/default
mattermost -&gt; /etc/nginx/sites-available/mattermost
</code></pre><h6 id="heading-3">　﻿</h6>
<p>本体の設定ファイルの中身を確認。</p>
<pre tabindex="0"><code>cat /etc/nginx/sites-available/mattermost
</code></pre><pre tabindex="0"><code>server {
    server_name chat.chooning.app;

    location / {
        proxy_pass http://localhost:8065;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    listen 443 ssl;
    ssl_certificate /etc/letsencrypt/live/chat.chooning.app/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/chat.chooning.app/privkey.pem;
    include /etc/letsencrypt/options-ssl-nginx.conf;
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;
}
</code></pre><p>設定ファイルの中に、HTTPからWebSocketへプロトコルをアップグレードする際に必要なヘッダー項目が抜けていることが分かる。これがないとWebSocket接続が確立できない。</p>
<h6 id="heading-4">　﻿</h6>
<p>修正</p>
<pre tabindex="0"><code>server {
    server_name chat.chooning.app;

    location / {
        proxy_pass http://localhost:8065;
        proxy_http_version 1.1;                           # これを追加
        proxy_set_header Upgrade $http_upgrade;           # これを追加
        proxy_set_header Connection &#34;upgrade&#34;;            # これを追加
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    listen 443 ssl;
    ssl_certificate /etc/letsencrypt/live/chat.chooning.app/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/chat.chooning.app/privkey.pem;
    include /etc/letsencrypt/options-ssl-nginx.conf;
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;
}
</code></pre><h6 id="heading-5">　﻿</h6>
<p>Nginxを再読み込み</p>
<pre tabindex="0"><code># 文法チェック
sudo nginx -t

# 成功したらNginxを再起動
sudo systemctl reload nginx
</code></pre><h2 id="原因その2configjsonの設定ミス">原因その2：config.jsonの設定ミス</h2>
<p>Nginxの設定を修正したことで「WebSocket connection closed, connection interrupted.」のエラーは解消されたものの、BoardsのUIが動かない現象は解決しなかった。</p>
<h6 id="heading-6">　﻿</h6>
<p>Dockerコンテナ内に入って、config.json（Mattermost本体の設定ファイル）の内容を確認する。</p>
<pre tabindex="0"><code>sudo docker exec -it mattermost_app_1 /bin/bash
cat /mattermost/config/config.json | grep -A 10 ServiceSettings
</code></pre><h6 id="heading-7">　﻿</h6>
<p>その結果、SiteURLとWebsocketURLが空であることが判明。この2つの値はMattermostが自身のURLやWebSocket接続先を認識するために必要なもので、ここが空だと接続が正しく行えない。</p>
<pre tabindex="0"><code>&#34;SiteURL&#34;: &#34;&#34;,
&#34;WebsocketURL&#34;: &#34;&#34;,
</code></pre><h6 id="heading-8">　﻿</h6>
<p>修正</p>
<pre tabindex="0"><code>sed -i &#39;s|&#34;SiteURL&#34;: &#34;&#34;|&#34;SiteURL&#34;: &#34;https://chat.chooning.app&#34;|&#39; /mattermost/config/config.json
sed -i &#39;s|&#34;WebsocketURL&#34;: &#34;&#34;|&#34;WebsocketURL&#34;: &#34;wss://chat.chooning.app&#34;|&#39; /mattermost/config/config.json
</code></pre><h6 id="heading-9">　﻿</h6>
<p>コンテナから出て、コンテナ再起動</p>
<pre tabindex="0"><code>exit
sudo docker restart mattermost_app_1
</code></pre><h6 id="heading-10">　﻿</h6>
<p>上記2つの修正を行ったことで、Boardが正常に使えるようになった＼(^o^)／</p>
<h2 id="副作用的に他のエラーthe-server-is-not-reachableも解決した">副作用的に他のエラー（「The server is not reachable.」）も解決した</h2>
<p>実はずっとネイティブアプリに「The server is not reachable.」というエラーが表示されていたのだが、WebSocket接続エラーを解決したことで偶然これも解決した。</p>
<div class="image-wrapper"><img src="/images/diary/mattermost-websocket-error/5r1nil9wlarcbjgvu2dth6.png" alt=""></div><p>この通知、初期セットアップ時からずっと表示されていたのだが、Mattermost自体は普通に使えており、<a href="https://forum.mattermost.com/t/intermittent-the-server-is-not-reachable-for-some-users-on-mobile/16884/6">フォーラムにも同様の報告が上がっていた</a>ので、まあネイティブアプリのバグかなと思って放置していた。しかし実際にはWebSocket接続が失敗していたために表示されていたっぽい／(^o^)＼</p>
<p>アプリがある程度は動いていたのは、WebSocketを使わない基本的なAPI通信が問題なく通っていたからではないかと思う。（通知やBoardsなどのリアルタイムUIは動かないが、通常の投稿やチャンネル閲覧などはHTTP通信だけで動作していた、ということなんじゃないかと思う。たぶん……）</p>
<h6 id="heading-11">　﻿</h6>
<p>何はともあれ、これでBoardsが使えるようになった。Slack的なコミュニケーションとNotion的なやつが同一アプリ内で使えるの快適すぐる！！！！！</p>
<div class="image-wrapper"><img src="/images/diary/mattermost-websocket-error/bpgrweqlqm2x7pwvqlxy.png" alt=""></div><h6 id="heading-12">　﻿</h6>
<p>Boardのセットアップに関する記事はこの土日に書く。この一週間ですっかりMattermostの虜や〜〜〜</p>

            
                    <script>
                        document.addEventListener('DOMContentLoaded', function() {
                            document.querySelectorAll('.image-wrapper img').forEach(function(img) {
                                const altText = img.getAttribute('alt');
                                if (altText) {
                                    img.parentElement.setAttribute('data-alt', altText);
                                } else {
                                    console.log('alt属性が空のimgタグを検出しました');
                                    img.parentElement.classList.add('no-alt'); 
                                }
                            });
                        });
                    </script>

                    <div class="social-action">
                        <div class="social-action__left">
                            <div class="social-action__line">
                                <div class="social-action__line-icon"></div>
                                <a href="https://lin.ee/eVcRqAC" target="_blank">
                                    このブログの更新通知をLINEで受け取る
                                </a>
                            </div>
                        </div>
                        <div class="social-action__right">
                            <a href="https://twitter.com/intent/tweet?text=Mattermost%e3%81%aeWebSocket%e6%8e%a5%e7%b6%9a%e3%82%a8%e3%83%a9%e3%83%bc%e3%82%92%e8%a7%a3%e6%b1%ba%e3%81%97%e3%81%9f&url=http%3a%2f%2flocalhost%3a1313%2fcolumn%2fmattermost-websocket-error%2f" target="_blank" class="social-action__x" data-show-count="false"></a>
                            <a href="http://b.hatena.ne.jp/entry/http://localhost:1313/column/mattermost-websocket-error/" target="_blank" class="social-action__hatena"></a>
                            
                        </div>
                    </div>
                </article>
                
            
            </ul>
        </div>
    </section>

                </main>

                
                <aside class="layout-tags" aria-label="セカンダリーナビゲーション">
                    
    <div class="diary-secondary-nav">
    <div class="diary-secondary-nav__section">
        <p class="diary-secondary-nav__heading">Tags</p>
        <div class="tweet-secondary-nav__tags">
            
            
                
                    
                        
                            
                        
                    
                        
                            
                        
                    
                
            
                
                    
                        
                    
                        
                            
                        
                    
                
            
                
                    
                        
                            
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                
            
                
                    
                        
                            
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                
            
                
                    
                        
                            
                        
                    
                        
                    
                
            
                
                    
                        
                    
                        
                    
                        
                            
                        
                    
                
            
                
                    
                        
                    
                        
                            
                        
                    
                        
                    
                
            
                
                    
                        
                            
                        
                    
                        
                    
                        
                            
                        
                    
                
            
            
            
                <span class="sidebar-tag" data-tag="SNS">SNS</span>
            
                <span class="sidebar-tag" data-tag="コミュニケーション">コミュニケーション</span>
            
                <span class="sidebar-tag" data-tag="ライブ">ライブ</span>
            
                <span class="sidebar-tag" data-tag="企画">企画</span>
            
                <span class="sidebar-tag" data-tag="佐渡">佐渡</span>
            
                <span class="sidebar-tag" data-tag="友情">友情</span>
            
                <span class="sidebar-tag" data-tag="台湾">台湾</span>
            
                <span class="sidebar-tag" data-tag="回転寿司">回転寿司</span>
            
                <span class="sidebar-tag" data-tag="引越し">引越し</span>
            
                <span class="sidebar-tag" data-tag="文化">文化</span>
            
                <span class="sidebar-tag" data-tag="横浜">横浜</span>
            
                <span class="sidebar-tag" data-tag="農作業">農作業</span>
            
                <span class="sidebar-tag" data-tag="音楽">音楽</span>
            
                <span class="sidebar-tag" data-tag="食べ物">食べ物</span>
            
                <span class="sidebar-tag" data-tag="高円寺">高円寺</span>
            
        </div>
    </div>
</div>


                </aside>
                
            </div>
        </div>
    </div>

    
    

<script async src="https://www.googletagmanager.com/gtag/js?id=G-K021MTL6NX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-K021MTL6NX');
</script>



    
    <script>
        (function() {
            
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', handleExternalLinks);
            } else {
                handleExternalLinks();
            }

            function handleExternalLinks() {
                const baseURL = 'http:\/\/localhost:1313\/';
                const baseHost = baseURL ? new URL(baseURL).hostname : window.location.hostname;
                
                
                const articleLinks = document.querySelectorAll('.article-item a[href]');
                
                articleLinks.forEach(function(link) {
                    const href = link.getAttribute('href');
                    
                    
                    if (!href || link.hasAttribute('target')) {
                        return;
                    }
                    
                    
                    if (href.startsWith('#') || 
                        href.startsWith('/') || 
                        href.startsWith('./') ||
                        href.startsWith('../') ||
                        (href.startsWith('http') && new URL(href, window.location.href).hostname === baseHost)) {
                        
                        return;
                    }
                    
                    
                    if (href.startsWith('http://') || href.startsWith('https://') || href.startsWith('//')) {
                        link.setAttribute('target', '_blank');
                        link.setAttribute('rel', 'noopener noreferrer');
                    }
                });
            }
        })();
    </script>

    
    <script>
        (function() {
            function initSidebarMinimize() {
                const sidebar = document.querySelector('.layout-sidebar');
                const minimizeBtn = document.getElementById('sidebar-minimize-btn');
                
                if (!sidebar || !minimizeBtn) return;
                
                
                
                updateButtonState();
                
                
                minimizeBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    sidebar.classList.toggle('is-minimized');
                    updateButtonState();
                });
                
                function updateButtonState() {
                    const isMinimized = sidebar.classList.contains('is-minimized');
                    if (isMinimized) {
                        minimizeBtn.setAttribute('aria-label', 'サイドバーを最大化');
                        minimizeBtn.setAttribute('data-tooltip', 'メニューを表示する');
                        minimizeBtn.querySelector('svg').style.transform = 'rotate(180deg)';
                    } else {
                        minimizeBtn.setAttribute('aria-label', 'サイドバーを最小化');
                        minimizeBtn.setAttribute('data-tooltip', 'メニューを非表示にする');
                        minimizeBtn.querySelector('svg').style.transform = 'rotate(0deg)';
                    }
                }
            }
            
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initSidebarMinimize);
            } else {
                initSidebarMinimize();
            }
        })();
    </script>

    <script>
        (function() {
            
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initHeaderScroll);
            } else {
                initHeaderScroll();
            }

            function initHeaderScroll() {
                const header = document.querySelector('.layout-header');
                if (!header) {
                    console.log('Header not found');
                    return;
                }

                
                if (header.children.length === 0) {
                    return;
                }

                let lastScrollTop = 0;
                let scrollTimeout = null;
                let isScrollingDown = false;
                let ticking = false;

                function getScrollTop() {
                    return window.pageYOffset || document.documentElement.scrollTop || 0;
                }

                function handleScroll() {
                    const scrollTop = getScrollTop();
                    
                    
                    if (Math.abs(scrollTop - lastScrollTop) < 1) {
                        return;
                    }

                    const scrollingDown = scrollTop > lastScrollTop;
                    const scrollingUp = scrollTop < lastScrollTop;

                    
                    if (scrollTimeout) {
                        clearTimeout(scrollTimeout);
                        scrollTimeout = null;
                    }

                    
                    if (scrollTop <= 100) {
                        header.classList.remove('hidden');
                        isScrollingDown = false;
                        lastScrollTop = scrollTop;
                        return;
                    }

                    
                    if (scrollingUp) {
                        header.classList.remove('hidden');
                        isScrollingDown = false;
                    }
                    
                    else if (scrollingDown) {
                        header.classList.add('hidden');
                        isScrollingDown = true;
                    }

                    lastScrollTop = scrollTop;

                    
                    if (isScrollingDown) {
                        scrollTimeout = setTimeout(function() {
                            header.classList.remove('hidden');
                            isScrollingDown = false;
                            scrollTimeout = null;
                        }, 3000);
                    }
                }

                
                lastScrollTop = getScrollTop();

                
                window.addEventListener('scroll', function() {
                    if (!ticking) {
                        window.requestAnimationFrame(function() {
                            handleScroll();
                            ticking = false;
                        });
                        ticking = true;
                    }
                }, { passive: true });

                
                handleScroll();
            }
        })();
    </script>
</body>
</html>
